<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generate CLUMPP output from a qlist — clumppExport • pophelper</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Generate CLUMPP output from a qlist — clumppExport" />
<meta property="og:description" content="Takes a qlist and combines several repeats for each K into a
single file along with a parameter file suitable for input to CLUMPP. The two
output files are organised into folders by K. This function only creates the 
input files for CLUMPP. It does not run CLUMPP." />
<meta property="og:image" content="https://github.com/royfrancis/pophelper/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pophelper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">
    <span class="fas fa-tools"></span>
     
    Vignette
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fas fa-book"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fas fa-history"></span>
     
    Versions
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/royfrancis/pophelper">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate CLUMPP output from a qlist</h1>
    <small class="dont-index">Source: <a href='https://github.com/royfrancis/pophelper/blob/master/R/pophelper.R'><code>R/pophelper.R</code></a></small>
    <div class="hidden name"><code>clumppExport.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Takes a qlist and combines several repeats for each K into a
single file along with a parameter file suitable for input to CLUMPP. The two
output files are organised into folders by K. This function only creates the 
input files for CLUMPP. It does not run CLUMPP.</p>
    </div>

    <pre class="usage"><span class='fu'>clumppExport</span><span class='op'>(</span>
  qlist <span class='op'>=</span> <span class='cn'>NULL</span>,
  prefix <span class='op'>=</span> <span class='cn'>NA</span>,
  parammode <span class='op'>=</span> <span class='cn'>NA</span>,
  paramrep <span class='op'>=</span> <span class='cn'>NA</span>,
  exportpath <span class='op'>=</span> <span class='cn'>NULL</span>,
  path <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>qlist</th>
      <td><p>A qlist (list of dataframes). An output from <code><a href='readQ.html'>readQ</a></code>.</p></td>
    </tr>
    <tr>
      <th>prefix</th>
      <td><p>A character prefix for folder names. By default, set to 'pop'.</p></td>
    </tr>
    <tr>
      <th>parammode</th>
      <td><p>A numeric 1, 2 or 3 indicating the algorithm option for
CLUMPP paramfile. Calculated automatically by default. Set this value to 3 if
CLUMPP runs too long. See details.</p></td>
    </tr>
    <tr>
      <th>paramrep</th>
      <td><p>A numeric indicating the number of repeats for CLUMPP
paramfile. Calculated automatically by default. See details.</p></td>
    </tr>
    <tr>
      <th>exportpath</th>
      <td><p>The path to export output files. To use current working directory, set <code>exportpath=getwd()</code>.</p></td>
    </tr>
    <tr>
      <th>path</th>
      <td><p>Deprecated. Use exportpath.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The combined file and paramfile are written into respective folders
named by K.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function only generates the files needed to run CLUMPP.
The CLUMPP executable can be downloaded and run for downstream steps. It can
be obtained from <a href='https://web.stanford.edu/group/rosenberglab/clumpp.html'>https://web.stanford.edu/group/rosenberglab/clumpp.html</a>.
Please remember to cite CLUMPP if you use it.<br /></p>
<p>When multiple repeats are run for each K in runs, the order of
clusters may be jumbled for each run. Therefore, when plotting multiple runs
within each K, the colours cannot be assigned correctly. The software CLUMPP
helps to overcome this issue by reordering the clusters correctly. This
function <code>clumppExport()</code> takes multiple runs for each K and combines
them into a single file and generates a parameter file for easy use with
CLUMPP. Further details for CLUMPP can be found here: <a href='https://academic.oup.com/bioinformatics/article/23/14/1801/188285'>Jakobsson, M., and
Rosenberg, N. A. (2007). CLUMPP: a cluster matching and permutation program
for dealing with label switching and multimodality in analysis of population
structure. Bioinformatics, 23(14), 1801-1806.</a><br /></p>
<p><strong>parammode</strong><br />
The parammode (M) is the type of algorithm used. Option 1 is 'FullSearch'
(takes the longest time), option 2 is 'Greedy' and option 3 is 'LargeKGreedy'
(fastest). If clumpp takes more than a few minutes, consider changing
parammode to a higher number (ex. from 2 to 3), or open the exported
paramfile and manually change GREEDY_OPTION to 3.<br /></p>
<p>The parammode and paramrep for CLUMPP paramfile is set based on this
calculation.
X &lt;- factorial(k)*((runs*(runs-1))/2)*k*ind, where k is number of
populations, runs is number of runs for k and ind is number of individuals.
If X &lt;= 100000000, then parammode is 2 and paramrep is 20, otherwise
parammode is 3 and paramrep is set to 500.<br /></p>
<p>To find out more about parammode (algorithm type) and paramrep (repeats),
refer to CLUMPP documentation.<br /></p>
<p>See the <a href='https://royfrancis.github.io/pophelper/articles/index.html#clumpp'>vignette</a> for more details.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='alignK.html'>alignK</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>

<span class='co'># generate input files for CLUMPP from STRUCTURE files</span>
<span class='va'>sfiles</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span>path<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"files/structure"</span>,package<span class='op'>=</span><span class='st'>"pophelper"</span><span class='op'>)</span>,
full.names<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>clumppExport</span><span class='op'>(</span><span class='fu'><a href='readQ.html'>readQ</a></span><span class='op'>(</span><span class='va'>sfiles</span><span class='op'>)</span>,exportpath<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/getwd.html'>getwd</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># generate input files for CLUMPP from ADMIXTURE files</span>
<span class='va'>afiles</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span>path<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"files/admixture"</span>,package<span class='op'>=</span><span class='st'>"pophelper"</span><span class='op'>)</span>,
full.names<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>clumppExport</span><span class='op'>(</span><span class='fu'><a href='readQ.html'>readQ</a></span><span class='op'>(</span><span class='va'>afiles</span><span class='op'>)</span>,exportpath<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/getwd.html'>getwd</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>

<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Roy Mathew Francis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


