<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pophelper 2.3.1 • pophelper</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Pophelper 2.3.1">
<meta property="og:description" content="pophelper">
<meta property="og:image" content="https://github.com/royfrancis/pophelper/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pophelper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">
    <span class="fas fa-tools"></span>
     
    Vignette
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fas fa-book"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fas fa-history"></span>
     
    Versions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/royfrancis/pophelper">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="index_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Pophelper 2.3.1</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/royfrancis/pophelper/blob/master/vignettes/index.Rmd"><code>vignettes/index.Rmd</code></a></small>
      <div class="hidden name"><code>index.Rmd</code></div>

    </div>

    
    
<p><strong>Roy Francis</strong> | 27-Dec-2020</p>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette/tutorial aims to demonstrate the use of R package <code>pophelper</code>. This package contains functions that are useful for processing output results from programs used in the analysis of population structure such as ADMIXTURE<sup>1</sup>, FASTSTRUCTURE<sup>6</sup>, STRUCTURE<sup>5</sup>, TESS<sup>3</sup>, BAPS<sup>8</sup> and any q-matrix output as a numeric tabular delimited file.</p>
<p>These software are popular programs used to discriminate populations, to determine population structure and to reveal the genetic composition of individuals using molecular markers. These programs generally use allelic frequency information to assign individuals to a pre-defined number of populations (<em>K</em>). The assignment is usually run for a range of <em>K</em> such as from <em>K</em>=2 to <em>K</em>=10. Multiple repeats are also usually carried out for each <em>K</em>. Each output file for each repeat of <em>K</em> showing the assignment probabilities of all individuals is referred to as the run file, cluster file or q-matrix file. <code>pophelper</code> has a set of functions that include reading into R, tabulating, summarising and plotting these run files.</p>
<p>This vignette covers the use of all important functions in the <code>pophelper</code> package. The demonstration is ordered in the manner of a typical workflow. Input and output codes are printed in a font different from body text like <code>this</code>.</p>
<p>Once the package is installed, the package is loaded as shown below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load library</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/royfrancis/pophelper">pophelper</a></span><span class="op">)</span>

<span class="co"># check version</span>
<span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageDescription</a></span><span class="op">(</span><span class="st">"pophelper"</span>, fields<span class="op">=</span><span class="st">"Version"</span><span class="op">)</span></code></pre></div>
<p>The next step is to set the working directory. The working directory is a folder that usually contains the run files of interest so as to allow R to access it. The working directory must have read-write-execute permissions. Functions may produce outputs such as text files or images which will be exported to the working directory. The working directory can be set by running the command below using a path or by selecting the folder interactively in the popup window.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="st">"path"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/choose.dir.html">choose.dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Standard help and documentation for all functions are obtained using <code><a href="https://rdrr.io/r/utils/Question.html">?</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="va">tabulateQ</span>
<span class="op">?</span><span class="va">summariseQ</span>
<span class="op">?</span><span class="va">collectRunsTess</span>
<span class="co"># if using RStudio, press tab inside function to see arguments.</span>
<span class="co"># readQ(&lt;press tab&gt;)</span></code></pre></div>
<p>For functions where one or more files need to be selected, the selection can be performed interactively. Windows users can use <code><a href="https://rdrr.io/r/utils/choose.files.html">choose.files(multi=T)</a></code> for multi-selection or <code><a href="https://rdrr.io/r/base/file.choose.html">file.choose()</a></code> for single selection. Mac users can use <code><a href="https://rdrr.io/r/base/file.choose.html">file.choose()</a></code> for single selection and <code>tk_choose.files()</code> from <code>tcltk</code> package for multiple selection.</p>
<p>For functions where files are exported, the export path/directory needs to be explicitly set using <code>èxportpath</code>. This is further mentioned under each function.</p>
<hr>
</div>
<div id="functions-overview" class="section level1">
<h1 class="hasAnchor">
<a href="#functions-overview" class="anchor"></a>Functions &amp; Overview</h1>
<p>All user functions in the <code>pophelper</code> package are listed below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># convert q-matrix run files (structure, tess 2.3, baps, basic, clumpp)</span>
<span class="co"># to R qlist object</span>
<span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># convert TESS3 R list object to qlist object</span>
<span class="fu"><a href="../reference/readQTess3.html">readQTess3</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># collate/tabulate a qlist</span>
<span class="fu"><a href="../reference/tabulateQ.html">tabulateQ</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># summarise an output from tabulateQ()</span>
<span class="fu"><a href="../reference/summariseQ.html">summariseQ</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># Align clusters</span>
<span class="fu"><a href="../reference/alignK.html">alignK</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># create single-line barplots from qlist</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># create multi-line barplots from qlist</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># export files for DISTRUCT from qlist</span>
<span class="fu"><a href="../reference/distructExport.html">distructExport</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># Run and plot the Evanno method for STRUCTURE data</span>
<span class="fu"><a href="../reference/evannoMethodStructure.html">evannoMethodStructure</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># collect TESS output from multiple directories into one</span>
<span class="fu"><a href="../reference/collectRunsTess.html">collectRunsTess</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># wrapper function to tabulate, summarise, perform evanno method and generate barplots from filenames/paths.</span>
<span class="fu"><a href="../reference/analyseQ.html">analyseQ</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<hr>
</div>
<div id="input-files" class="section level1">
<h1 class="hasAnchor">
<a href="#input-files" class="anchor"></a>Input files</h1>
<p>Generally speaking, there are five input file formats that can be defined. All are text formats. These are STRUCTURE run files, TESS 2.3 run files (-TR files in folders), BAPS, BASIC (simple delimited files) or a CLUMPP associated file.</p>
<p>STRUCTURE, TESS 2.3 and BAPS run files have specific format as shown below in <strong>Fig. 1</strong>. BASIC files are numeric delimited tabular file like ADMIXTURE run files and FASTSTRUCTURE meanQ files. They can also be a generic numeric tabular tab, space or comma-delimited files without headers.</p>
<p>CLUMPP is no longer required for the workflow and it is included here as legacy content. CLUMPP associated files are COMBINED, ALIGNED or MERGED files for use with CLUMPP. The COMBINED file is generated using the function <code><a href="../reference/clumppExport.html">clumppExport()</a></code>. The ALIGNED and MERGED files are generated by CLUMPP. A sample CLUMPP format is shown in <strong>Fig. 2</strong>.</p>
<div class="figure">
<img src="figures/input-preview.png" alt=""><p class="caption">input-preview</p>
</div>
<p><b>Fig. </b> 1: <em>A preview of the input files. STRUCTURE (Left), TESS 2.3 (middle left), BAPS (middle right) and BASIC file (right).</em></p>
<div class="figure">
<img src="figures/clumpp-format.png" alt=""><p class="caption">clumpp-format</p>
</div>
<p><b>Fig. </b> 2: <em>A preview of the CLUMPP format file.</em></p>
<p>Sample files for inspection can be downloaded here. <a href="https://github.com/royfrancis/pophelper/tree/master/inst/files/structure">STRUCTURE 2.3.4</a>, <a href="https://github.com/royfrancis/pophelper/tree/master/inst/files/structure-ci">STRUCTURE 2.3.4 with confidence interval</a>, <a href="https://github.com/royfrancis/pophelper/tree/master/inst/files/tess">TESS 2.3</a>, <a href="https://github.com/royfrancis/pophelper/tree/master/inst/files/baps">BAPS</a>, <a href="https://github.com/royfrancis/pophelper/tree/master/inst/files/admixture">ADMIXTURE</a>, <a href="https://github.com/royfrancis/pophelper/tree/master/inst/files/faststructure">fastSTRUCTURE</a>, <a href="https://github.com/royfrancis/pophelper/tree/master/inst/files/basic/tab">TAB delimited</a>, <a href="https://github.com/royfrancis/pophelper/tree/master/inst/files/basic/comma">COMMA delimited</a>, <a href="https://github.com/royfrancis/pophelper/tree/master/inst/files/basic/space">SPACE delimited</a>, <a href="https://github.com/royfrancis/pophelper/blob/master/inst/files/STRUCTUREpop_K4-combined.txt">COMBINED CLUMPP file</a>, <a href="https://github.com/royfrancis/pophelper/blob/master/inst/files/STRUCTUREpop_K4-combined-aligned.txt">ALIGNED CLUMPP file</a> and <a href="https://github.com/royfrancis/pophelper/blob/master/inst/files/STRUCTUREpop_K4-combined-merged.txt">MERGED CLUMPP file</a>.</p>
<p>The plotting functions <code><a href="../reference/plotQ.html">plotQ()</a></code> and <code><a href="../reference/plotQMultiline.html">plotQMultiline()</a></code> require group labels as ‘data.frame’ datatype which can be read into R from a tab-delimited or csv file. ‘data.frame’ is used rather than a character data type because multiple label sets can be used. The labels for <code><a href="../reference/distructExport.html">distructExport()</a></code> must be character datatype. For a sample tab-delimited group labels file, <a href="https://github.com/royfrancis/pophelper/blob/master/inst/files/metadata.txt">click here</a>.</p>
<p>Once the run files are read into R, it is stored internally as a ‘qlist’ object. For more information on ‘qlist’ objects and advanced operations on ‘qlist’, see section: <strong>Working with qlists</strong>. Internal details of ‘qlist’ is not critical to working with this package.</p>
<hr>
</div>
<div id="workflow" class="section level1">
<h1 class="hasAnchor">
<a href="#workflow" class="anchor"></a>Workflow</h1>
<p>In this section, we will look at how these functions are used, their syntax and typical order of workflow. The workflow is similar for all input filetypes. A few specific functions are specific to certain filetypes.</p>
<div class="figure">
<img src="figures/workflow.svg" alt=""><p class="caption">workflow</p>
</div>
<p><b>Fig. </b> 3: <em>Workflow for all filetypes. Files/objects are indicated in black text and functions are indicated in blue. The <code><a href="../reference/analyseQ.html">analyseQ()</a></code> function is a wrapper function which can be used to run several functions together. This is indicated by the orange path. Functions indicated with superscripts 1 and 2 are only applicable to specific filetypes. <code><a href="../reference/collectRunsTess.html">collectRunsTess()</a></code> is used to consolidate and rename TESS runs. <code><a href="../reference/evannoMethodStructure.html">evannoMethodStructure()</a></code> is used to perform the Evanno method for STRUCTURE runs.</em></p>
<p>The <code>pophelper</code> library must be loaded and a working directory must be set.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/royfrancis/pophelper">pophelper</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="st">"path-to-wd"</span><span class="op">)</span></code></pre></div>
<div id="collectrunstess" class="section level2">
<h2 class="hasAnchor">
<a href="#collectrunstess" class="anchor"></a>collectRunsTess</h2>
<p>This function is applicable only to TESS 2.3 runs. Unlike STRUCTURE runs which are exported into a single directory, TESS output files are exported into separate directories by run. This means that one needs to go into individual folders to obtain the run file. The function <code><a href="../reference/collectRunsTess.html">collectRunsTess()</a></code> collects TESS cluster files from individual run folders into one new folder and rename each runfile by the folder name. Set working directory first and run basic usage.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># basic usage</span>
<span class="fu"><a href="../reference/collectRunsTess.html">collectRunsTess</a></span><span class="op">(</span>runsdir<span class="op">=</span><span class="st">"path-to-tess-runs-root-dir"</span><span class="op">)</span>

<span class="co"># another usage</span>
<span class="va">path</span> <span class="op">&lt;-</span> <span class="st">"path-to-tess-runs-root-dir"</span>
<span class="fu"><a href="../reference/collectRunsTess.html">collectRunsTess</a></span><span class="op">(</span>runsdir<span class="op">=</span><span class="va">path</span><span class="op">)</span>

<span class="co"># another usage</span>
<span class="fu"><a href="../reference/collectRunsTess.html">collectRunsTess</a></span><span class="op">(</span>runsdir<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/choose.dir.html">choose.dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Within each TESS run folder, the function searches for filename ending with ‘TR.txt’ as the cluster file. This file is copied to the new folder and renamed with the name of the respective run directory. Therefore, DO NOT manually rename original TESS run files or directories.</p>
</div>
<div id="readq" class="section level2">
<h2 class="hasAnchor">
<a href="#readq" class="anchor"></a>readQ</h2>
<p>All input filetypes (STRUCTURE, TESS 2.3, BASIC, CLUMPP) can be read into R and converted to a ‘qlist’ object using the function <code><a href="../reference/readQ.html">readQ()</a></code>. The argument <code>filetype</code> is used to specify the input filetype. By default, <code>filetype</code> is set to ‘auto’ which automatically detects input filetype. If this does not work, <code>filetype</code> can also be manually set.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="op">)</span>                     <span class="co"># automatically detects input filetype</span>
<span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>filetype<span class="op">=</span><span class="st">"auto"</span><span class="op">)</span>      <span class="co"># automatically detects input filetype</span>
<span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>filetype<span class="op">=</span><span class="st">"structure"</span><span class="op">)</span> <span class="co"># Convert STRUCTURE run files to qlist</span>
<span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>filetype<span class="op">=</span><span class="st">"tess"</span><span class="op">)</span>      <span class="co"># Convert TESS2 run files to qlist</span>
<span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>filetype<span class="op">=</span><span class="st">"baps"</span><span class="op">)</span>      <span class="co"># Convert BAPS run files to qlist</span>
<span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>filetype<span class="op">=</span><span class="st">"basic"</span><span class="op">)</span>     <span class="co"># Convert delimited numeric text files to qlist</span>
<span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>filetype<span class="op">=</span><span class="st">"clumpp"</span><span class="op">)</span>    <span class="co"># Convert CLUMPP format files to qlist</span></code></pre></div>
<p>You can also explicitly use filetype specific functions: <code><a href="../reference/readQStructure.html">readQStructure()</a></code>,<code><a href="../reference/readQTess.html">readQTess()</a></code>,<code><a href="../reference/readQBaps.html">readQBaps()</a></code>,<code><a href="../reference/readQBasic.html">readQBasic()</a></code> or <code><a href="../reference/readQClumpp.html">readQClumpp()</a></code>. If TESS3 is run in R (tess3r), you get a TESS3 list object inside R. This list can be read into pophelper using <code><a href="../reference/readQTess3.html">readQTess3()</a></code>.</p>
<p>When specifying location to a file locally, use one of below:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># file is located in the current working directory. use full filename.</span>
<span class="va">sfiles</span> <span class="op">&lt;-</span> <span class="st">"file.structure"</span>
<span class="va">sfiles</span> <span class="op">&lt;-</span> <span class="st">"file.txt"</span>
<span class="co"># file is located in a directory relative to the current working directory.</span>
<span class="va">sfiles</span> <span class="op">&lt;-</span> <span class="st">"./path/path/file.txt"</span>
<span class="co"># absolute path.</span>
<span class="va">sfiles</span> <span class="op">&lt;-</span> <span class="st">"C:/path/path/path/file.txt"</span>

<span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">sfiles</span><span class="op">)</span></code></pre></div>
<p>For this tutorial, we will use the sample files accompanied with this package. Therefore we read file from within the R package.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># STRUCTURE files (do not use this command to read local files)</span>
<span class="va">sfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/structure"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>, full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="co"># basic usage</span>
<span class="va">slist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">sfiles</span><span class="op">)</span>
<span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">sfiles</span>,filetype<span class="op">=</span><span class="st">"structure"</span><span class="op">)</span>
<span class="co"># select files interactively</span>
<span class="co"># readQ(files=choose.files(multi=TRUE))</span>
<span class="co"># check class of ouput</span>
<span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">slist</span><span class="op">)</span>
<span class="co"># view head of first converted file</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>

<span class="co"># TESS files (do not use this command to read local files)</span>
<span class="va">tfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/tess"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>, full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">tlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">tfiles</span><span class="op">)</span>
<span class="co"># select files interactively</span>
<span class="co"># readQ(files=choose.files(multi=TRUE))</span>

<span class="co"># use BAPS files (do not use this command to read local files)</span>
<span class="va">bfiles</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/baps"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>, full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">blist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">bfiles</span><span class="op">)</span>

<span class="co"># use ADMIXTURE files (do not use this command to read local files)</span>
<span class="va">afiles</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/admixture"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>, full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">alist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">afiles</span><span class="op">)</span>

<span class="co"># use FASTSTRUCTURE files (do not use this command to read local files)</span>
<span class="va">ffiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/faststructure"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>, full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">flist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">ffiles</span><span class="op">)</span>

<span class="co"># use space-delimited text files (do not use this command to read local files)</span>
<span class="va">msfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/basic/space"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>, full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">mslist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">msfiles</span><span class="op">)</span>

<span class="co"># use tab-delimited text files (do not use this command to read local files)</span>
<span class="va">mtfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/basic/tab"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>, full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">mtlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">mtfiles</span><span class="op">)</span>

<span class="co"># use comma-separated text files (do not use this command to read local files)</span>
<span class="va">mcfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/basic/comma"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>, full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">mclist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">mcfiles</span><span class="op">)</span></code></pre></div>
<p>TESS 3 when run within R produces a <code>tess3</code> object. This object can be converted to a pophelper qlist using the function <code><a href="../reference/readQTess3.html">readQTess3()</a></code>. Runs are labelled sample1, sample2 etc.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t3obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"tess3.rds"</span><span class="op">)</span>
<span class="va">t3list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQTess3.html">readQTess3</a></span><span class="op">(</span><span class="va">t3obj</span><span class="op">)</span></code></pre></div>
<p>Each run is converted to dataframes of assignment probabilities of all individuals in <em>K</em> clusters denoted as Cluster1, Cluster 2 etc. The dataframes are placed in named lists. The names are obtained from filenames. Filename suffixes such as .txt, .csv, .tsv and .meanQ are dropped. In case filenames are missing or not available, lists are named sample1, sample2 etc.</p>
<p>Each ‘data.frame’ has some associated metadata, which is especially important for STRUCTURE runs. When reading in STRUCTURE runs using <code><a href="../reference/readQ.html">readQ()</a></code>, metadata such as number of loci, number of burnins, reps, estimated log probability etc., which are required for the Evanno method are stored with each ‘data.frame’ as attributes.</p>
<p>TESS 3 attributes <em>ind</em>, <em>k</em>, <em>loci</em>, <em>gif</em>, <em>rmse</em>, <em>crossentropy</em> and <em>ploidy</em> are retained.</p>
<p>The attributes of the run can be accessed as below.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># qlist attributes</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">slist</span><span class="op">)</span>
<span class="co"># dataframe attributes</span>
<span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co"># attributes of all runs</span>
<span class="co"># lapply(slist,attributes)</span>
<span class="co">## $names</span>
<span class="co">##  [1] "structure_01" "structure_02" "structure_03" "structure_04" "structure_05"</span>
<span class="co">##  [6] "structure_06" "structure_07" "structure_08" "structure_09" "structure_10"</span>
<span class="co">## [11] "structure_11" "structure_12" "structure_13" "structure_14" "structure_15"</span>
<span class="co">## [16] "structure_16" "structure_17"</span>
<span class="co">## </span>
<span class="co">## $names</span>
<span class="co">## [1] "Cluster1" "Cluster2"</span>
<span class="co">## </span>
<span class="co">## $class</span>
<span class="co">## [1] "data.frame"</span>
<span class="co">## </span>
<span class="co">## $row.names</span>
<span class="co">##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18</span>
<span class="co">##  [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36</span>
<span class="co">##  [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54</span>
<span class="co">##  [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72</span>
<span class="co">##  [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90</span>
<span class="co">##  [91]  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108</span>
<span class="co">## [109] 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126</span>
<span class="co">## [127] 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144</span>
<span class="co">## [145] 145 146 147 148 149</span>
<span class="co">## </span>
<span class="co">## $ind</span>
<span class="co">## [1] 149</span>
<span class="co">## </span>
<span class="co">## $k</span>
<span class="co">## [1] 2</span>
<span class="co">## </span>
<span class="co">## $loci</span>
<span class="co">## [1] 25</span>
<span class="co">## </span>
<span class="co">## $burnin</span>
<span class="co">## [1] 1e+05</span>
<span class="co">## </span>
<span class="co">## $reps</span>
<span class="co">## [1] 1e+06</span>
<span class="co">## </span>
<span class="co">## $elpd</span>
<span class="co">## [1] -7509.5</span>
<span class="co">## </span>
<span class="co">## $mvll</span>
<span class="co">## [1] -7387.2</span>
<span class="co">## </span>
<span class="co">## $vll</span>
<span class="co">## [1] 244.6</span></code></pre></div>
<p>STRUCTURE files which contain confidence intervals maybe read in by setting the argument <code>readci=TRUE</code>. The confidence intervals are added to each run data.frame as an attribute named <strong>ci</strong>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># read some structure files with confidence intervals</span>
<span class="va">sfiles1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/structure-ci"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>,full.names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">slist1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">sfiles1</span>, readci<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># check names of attributes of the first file</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html">attributes</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="co">##  [1] "names"     "class"     "row.names" "ind"       "k"         "loci"     </span>
<span class="co">##  [7] "burnin"    "reps"      "elpd"      "mvll"      "vll"       "ci"</span></code></pre></div>
<p>The ci attribute itself is a dataframe with low and high values for each cluster and rows equal to number of samples.</p>
<pre><code>##   Cluster1L Cluster1H Cluster2L Cluster2H
## 1     0.641     0.908     0.092     0.359
## 2     0.691     0.945     0.055     0.309
## 3     0.589     0.864     0.136     0.411
## 4     0.451     0.731     0.269     0.549
## 5     0.620     0.862     0.138     0.380
## 6     0.596     0.872     0.128     0.404</code></pre>
<p>If individual labels are present in the STRUCTURE file, they can be imported as rownames by setting <code>indlabfromfile=T</code>. Space in labels may be replaced by underscore. Incorrect parsing with internal population flags may introduce underscores. If duplicate labels are found, the labels are not imported. This is applicable only for STRUCTURE files.</p>
<p>Below is a sample data when <code>indlabfromfile=F</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">slist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">sfiles</span>, indlabfromfile<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">##   Cluster1 Cluster2</span>
<span class="co">## 1    0.965    0.035</span>
<span class="co">## 2    0.977    0.023</span>
<span class="co">## 3    0.961    0.039</span>
<span class="co">## 4    0.975    0.025</span>
<span class="co">## 5    0.974    0.026</span>
<span class="co">## 6    0.982    0.018</span></code></pre></div>
<p>And below is sample data when <code>indlabfromfile=T</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># include individual names from STRUCTURE file as row names</span>
<span class="va">slist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">sfiles</span>, indlabfromfile<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">##        Cluster1 Cluster2</span>
<span class="co">## I13825    0.965    0.035</span>
<span class="co">## I13826    0.977    0.023</span>
<span class="co">## I13827    0.961    0.039</span>
<span class="co">## I13828    0.975    0.025</span>
<span class="co">## I13829    0.974    0.026</span>
<span class="co">## I13830    0.982    0.018</span></code></pre></div>
<p>CLUMPP files (COMBINED, ALIGNED and MERGED) files can also be converted to a ‘qlist’ using <code><a href="../reference/readQ.html">readQ()</a></code>. We use some sample files from the package. To create CLUMPP files, see section on clumppExport.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">co</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/STRUCTUREpop_K4-combined.txt"</span>, package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>
<span class="va">al</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/STRUCTUREpop_K4-combined-aligned.txt"</span>, package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>
<span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/STRUCTUREpop_K4-combined-merged.txt"</span>, package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>

<span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">co</span><span class="op">)</span>
<span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">al</span><span class="op">)</span>
<span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">me</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">co</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>For CLUMPP files containing multiple runs, each run name is suffixed by a -1, -2 etc. <code><a href="https://rdrr.io/r/base/names.html">names(readQ(co))</a></code>.</p>
<p>Any tabular data that can be read into R and converted to a data.frame can be easily converted to a qlist. For information on the ‘qlist’ object and advanced operations on ‘qlist’, see section ‘Working with qlists’.</p>
</div>
<div id="tabulateq" class="section level2">
<h2 class="hasAnchor">
<a href="#tabulateq" class="anchor"></a>tabulateQ</h2>
<p>The function <code><a href="../reference/tabulateQ.html">tabulateQ()</a></code> takes a ‘qlist’ and produces a table of runs with various parameters. The results can be pointed to a variable for further use.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># basic usage</span>
<span class="va">tr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tabulateQ.html">tabulateQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist</span><span class="op">)</span>
<span class="fu"><a href="../reference/tabulateQ.html">tabulateQ</a></span><span class="op">(</span><span class="va">tlist</span><span class="op">)</span>
<span class="fu"><a href="../reference/tabulateQ.html">tabulateQ</a></span><span class="op">(</span><span class="va">alist</span>, writetable<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># choose files</span>
<span class="co"># files=choose.files(multi=TRUE)</span>
<span class="fu"><a href="../reference/tabulateQ.html">tabulateQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">files</span><span class="op">)</span><span class="op">)</span>

<span class="op">?</span><span class="va">tabulateQ</span>
<span class="co"># tabulateQ(qlist=NULL, sorttable=TRUE, writetable=FALSE, exportpath=NULL)</span>
<span class="co"># To write results to working directory, set writetable=TRUE and exportpath="."</span>
<span class="co"># Result table is sorted by loci, ind and k. To see original order, set sorttable=FALSE</span></code></pre></div>
<p>For all filetypes, the <code><a href="../reference/tabulateQ.html">tabulateQ()</a></code> function returns a table with three columns namely filename, <em>K</em> and number of individuals. Note that by default the table is sorted by ind and <em>K</em>.</p>
<p><b>Tab. </b> 1: <em>A tabulated table of TESS runs.</em></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/tabulateQ.html">tabulateQ</a></span><span class="op">(</span><span class="va">tlist</span><span class="op">)</span><span class="op">)</span>
<span class="co">##       file k ind</span>
<span class="co">## 1  tess_01 2  75</span>
<span class="co">## 8  tess_08 2  75</span>
<span class="co">## 15 tess_15 2  75</span>
<span class="co">## 2  tess_02 3  75</span>
<span class="co">## 9  tess_09 3  75</span>
<span class="co">## 16 tess_16 3  75</span></code></pre></div>
<p>To keep runs in the original order, use <code>sorttable=FALSE</code>.</p>
<p><b>Tab. </b> 2: <em>A tabulated table of TESS runs unsorted.</em></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/tabulateQ.html">tabulateQ</a></span><span class="op">(</span><span class="va">tlist</span>,sorttable<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="co">##      file k ind</span>
<span class="co">## 1 tess_01 2  75</span>
<span class="co">## 2 tess_02 3  75</span>
<span class="co">## 3 tess_03 4  75</span>
<span class="co">## 4 tess_04 5  75</span>
<span class="co">## 5 tess_05 6  75</span>
<span class="co">## 6 tess_06 7  75</span></code></pre></div>
<p>For STRUCTURE runs, the <code><a href="../reference/tabulateQ.html">tabulateQ()</a></code> function produces additional columns namely number of loci, number of burn-ins, number of replicates (reps), estimated ln probability of data (elpd), mean value of ln likelihood (mvll) and variance of ln likelihood (vll). The table is sorted by loci, ind and <em>K</em>.</p>
<p><b>Tab. </b> 3: <em>A tabulated table of STRUCTURE runs.</em></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/tabulateQ.html">tabulateQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">)</span><span class="op">)</span>
<span class="co">##            file k ind loci burnin  reps    elpd    mvll   vll</span>
<span class="co">## 1  structure_01 2 149   25  1e+05 1e+06 -7509.5 -7387.2 244.6</span>
<span class="co">## 2  structure_02 2 149   25  1e+05 1e+06 -7508.5 -7387.2 242.6</span>
<span class="co">## 9  structure_09 2 149   25  1e+05 1e+06 -7510.1 -7387.4 245.3</span>
<span class="co">## 3  structure_03 3 149   25  1e+05 1e+06 -7475.8 -7268.8 414.1</span>
<span class="co">## 4  structure_04 3 149   25  1e+05 1e+06 -7475.7 -7268.9 413.6</span>
<span class="co">## 10 structure_10 3 149   25  1e+05 1e+06 -7476.5 -7268.7 415.4</span></code></pre></div>
<p>Missing values are given NA. The tabulated output can be written to the working directory as a text file by setting the argument <code>writetable=T</code>. In this case, the output path must be explicitly specified like <code>exportpath="./some_directory/"</code>. To use the current working directory, you can use <code>exportpath=getwd()</code>.</p>
</div>
<div id="summariseq" class="section level2">
<h2 class="hasAnchor">
<a href="#summariseq" class="anchor"></a>summariseQ</h2>
<p>The table produced using <code><a href="../reference/tabulateQ.html">tabulateQ()</a></code> can be further collapsed by <em>K</em> based on the number of runs. The output table from <code><a href="../reference/tabulateQ.html">tabulateQ()</a></code> can be passed as input to <code><a href="../reference/summariseQ.html">summariseQ()</a></code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># basic usage</span>
<span class="va">sr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summariseQ.html">summariseQ</a></span><span class="op">(</span><span class="va">tr1</span><span class="op">)</span>
<span class="fu"><a href="../reference/summariseQ.html">summariseQ</a></span><span class="op">(</span><span class="va">tr1</span>, writetable<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># another usage</span>
<span class="co"># sr1 &lt;- summariseQ(tabulateQ(qlist=choose.files()))</span></code></pre></div>
<p><b>Tab. </b> 4: <em>A summarised table of TESS runs.</em></p>
<pre><code>##   ind k runs
## 1  75 2    3
## 2  75 3    3
## 3  75 4    3
## 4  75 5    3
## 5  75 6    3
## 6  75 7    3</code></pre>
<p>For all filetypes the <code><a href="../reference/summariseQ.html">summariseQ()</a></code> function returns 3 columns namely individuals, <em>K</em> and the number of runs.</p>
<p>For STRUCTURE runs, the <code><a href="../reference/summariseQ.html">summariseQ()</a></code> function returns additional 5 columns namely loci, Mean estimated ln probability of data, standard deviation of estimated ln probability of data, estimated ln probability of data minus standard deviation and estimated ln probability of data plus standard deviation.</p>
<p><b>Tab. </b> 5: <em>A summarised table of STRUCTURE runs.</em></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="../reference/summariseQ.html">summariseQ</a></span><span class="op">(</span><span class="fu"><a href="../reference/tabulateQ.html">tabulateQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">##   loci ind k runs  elpdmean     elpdsd   elpdmin   elpdmax</span>
<span class="co">## 1   25 149 2    3 -7509.367  0.8082904 -7510.175 -7508.558</span>
<span class="co">## 2   25 149 3    3 -7476.000  0.4358899 -7476.436 -7475.564</span>
<span class="co">## 3   25 149 4    3 -7650.800 46.1418465 -7696.942 -7604.658</span>
<span class="co">## 4   25 149 5    3 -7743.567 74.0671542 -7817.634 -7669.500</span>
<span class="co">## 5   25 149 6    3 -7985.833 32.6353081 -8018.469 -7953.198</span>
<span class="co">## 6   25 149 7    2 -8614.000 60.5283405 -8674.528 -8553.472</span></code></pre></div>
<p>The summarised runs can be written to the working directory as a text file by setting the argument <code>writetable=T</code>. In this case, the output path must be explicitly specified like <code>exportpath="./some_directory/"</code>. To use the current working directory, you can use <code>exportpath=getwd()</code>.</p>
</div>
<div id="evannomethodstructure" class="section level2">
<h2 class="hasAnchor">
<a href="#evannomethodstructure" class="anchor"></a>evannoMethodStructure</h2>
<p>This function is only applicable to STRUCTURE runs.</p>
<p>The Evanno method<sup>2</sup> is used to estimate the optimal number of <em>K</em>. The summarised runs table output from<code><a href="../reference/summariseQ.html">summariseQ()</a></code> function can be input to <code><a href="../reference/evannoMethodStructure.html">evannoMethodStructure()</a></code>. The <code><a href="../reference/evannoMethodStructure.html">evannoMethodStructure()</a></code> function creates an Evanno derivative plot if suitable conditions are met. A resulting table is also returned. The plot can be written to file using argument <code>exportplot=T</code>. The table can be written to file using <code>writetable=T</code>. In these cases, the output path must be explicitly specified like <code>exportpath="./some_directory/"</code>. To use the current working directory, you can use <code>exportpath=getwd()</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># basic usage</span>
<span class="fu"><a href="../reference/evannoMethodStructure.html">evannoMethodStructure</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">sr1</span><span class="op">)</span>

<span class="co"># another usage</span>
<span class="va">em</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evannoMethodStructure.html">evannoMethodStructure</a></span><span class="op">(</span><span class="fu"><a href="../reference/summariseQ.html">summariseQ</a></span><span class="op">(</span><span class="fu"><a href="../reference/tabulateQ.html">tabulateQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># to export a plot</span>
<span class="fu"><a href="../reference/evannoMethodStructure.html">evannoMethodStructure</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">sr1</span>,exportplot<span class="op">=</span><span class="cn">T</span>,exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co"># do not compute plot, only return results as table</span>
<span class="va">em</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evannoMethodStructure.html">evannoMethodStructure</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">sr1</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">F</span><span class="op">)</span>

<span class="co"># to export plot and table</span>
<span class="fu"><a href="../reference/evannoMethodStructure.html">evannoMethodStructure</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">sr1</span>,exportplot<span class="op">=</span><span class="cn">T</span>,writetable<span class="op">=</span><span class="cn">T</span>,na.rm<span class="op">=</span><span class="cn">T</span>,exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co"># returns both data and plot</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evannoMethodStructure.html">evannoMethodStructure</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">sr1</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="co"># to return only plot and save it</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evannoMethodStructure.html">evannoMethodStructure</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">sr1</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,returndata<span class="op">=</span><span class="cn">F</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summariseQ.html">summariseQ</a></span><span class="op">(</span><span class="fu"><a href="../reference/tabulateQ.html">tabulateQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">)</span><span class="op">)</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evannoMethodStructure.html">evannoMethodStructure</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">sr1</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,returndata<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">12</span>,linesize<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>
<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-27-1.svg" width="480" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 4: <em>Plots produced from the Evanno method.</em></p>
<p>The Evanno method results table has 15 columns namely number of loci (loci), number of individuals (ind), <em>K</em> value (k), number of runs (runs), Mean estimated ln probability of data (elpdmean), Standard deviation (elpdsd), Estimated ln probability of data minus standard deviation (elpdmin), Estimated ln probability of data plus standard deviation (elpdmax), First derivative (lnk1), Max error of first derivative (lnk1max), Min error of first derivative (lnk1min), Second derivative (lnk2), Max error of second derivative (lnk2max), Min error of second derivative (lnk2min) and deltaK.</p>
<p><b>Tab. </b> 6: <em>Results of the Evanno method.</em></p>
<pre><code>##   loci ind k runs  elpdmean     elpdsd   elpdmin   elpdmax       lnk1
## 1   25 149 2    3 -7509.367  0.8082904 -7510.175 -7508.558         NA
## 2   25 149 3    3 -7476.000  0.4358899 -7476.436 -7475.564   33.36667
## 3   25 149 4    3 -7650.800 46.1418465 -7696.942 -7604.658 -174.80000
## 4   25 149 5    3 -7743.567 74.0671542 -7817.634 -7669.500  -92.76667
## 5   25 149 6    3 -7985.833 32.6353081 -8018.469 -7953.198 -242.26667
## 6   25 149 7    2 -8614.000 60.5283405 -8674.528 -8553.472 -628.16667
##      lnk1max    lnk1min      lnk2   lnk2max   lnk2min     deltaK
## 1         NA         NA        NA        NA        NA         NA
## 2   33.73907   32.99427 208.16667 253.50022 162.83311 477.567086
## 3 -129.09404 -220.50596  82.03333  99.81398  64.25268   1.777851
## 4  -64.84136 -120.69197 149.50000 163.00654 135.99346   2.018439
## 5 -200.83482 -283.69851 385.90000 399.43881 372.36119  11.824616
## 6 -600.27363 -656.05970        NA        NA        NA         NA</code></pre>
<p>The peak of deltaK is usually used to estimate the best value of <em>K</em>.</p>
<p>The Evanno method can be computed only if these criteria are met: At least 3 values of <em>K</em> must be available, values of <em>K</em> must be sequential (ie; there must not be missing values of <em>K</em>), number of individuals and loci must be same in all runs. If number of repeats for any <em>K</em> is less than 2, then results may not be reliable. In case the Evanno method cannot be computed, a plot of ELPD over <em>K</em> is produced referred to as the kPlot.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evannoMethodStructure.html">evannoMethodStructure</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">sr1</span><span class="op">[</span><span class="op">-</span><span class="fl">3</span>,<span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,returndata<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">12</span>,linesize<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span>
<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-29-1.svg" width="288" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 5: <em>K plot.</em></p>
</div>
<div id="alignk" class="section level2">
<h2 class="hasAnchor">
<a href="#alignk" class="anchor"></a>alignK</h2>
<p>When multiple repeats are run for each <em>K</em>, the order of clusters may be jumbled for each run. Therefore, when plotting multiple runs within each <em>K</em>, the colours cannot be assigned correctly as shown in figure below.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/structure"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>, full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">slist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">sfiles</span><span class="op">)</span>

<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">10</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span><span class="op">)</span>
<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-30-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 6: <em>Three runs of K=3 with jumbled clusters.</em></p>
<p>The function <code><a href="../reference/alignK.html">alignK()</a></code> helps to overcome this issue by reordering the clusters suitably. Once the clusters have been aligned, the data can be plotted again.</p>
<div class="alert alert-warning" role="alert">
<p>Note that all runs must have the same number of individuals to run this function.</p>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">slist1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alignK.html">alignK</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">10</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span><span class="op">)</span>
<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-31-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 7: <em>Three runs of K=3 with clusters aligned.</em></p>
<p>The information remains the same, but the clusters have been switched so that colours match to the same clusters. This is what I refer to as <em>aligning within K</em>. The same idea also works across K. For example, consider the example below.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span><span class="op">)</span>
<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-32-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 8: <em>Three runs with K=3 and K=4 before alignment.</em></p>
<p>The first two runs are <em>K=3</em> and the bottom run is <em>K=4</em>. It is clear that the light blue region on the right in <em>K=4</em> should be a red or a blue based on the first and second runs. If we run <code><a href="../reference/alignK.html">alignK()</a></code> on this dataset, we get as below.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="fu"><a href="../reference/alignK.html">alignK</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span><span class="op">)</span>
<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-33-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 9: <em>Three runs with K=3 and K=4 after alignment.</em></p>
<p>Now we see that red cluster is consistent within and across <em>K</em>. This is referred to as <em>aligning across K</em>. Although, this may be more and more unreliable as <em>K</em> increases.</p>
<p>We can look at one more example of before and after alignment.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="fu"><a href="../reference/sortQ.html">sortQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="fu"><a href="../reference/alignK.html">alignK</a></span><span class="op">(</span><span class="fu"><a href="../reference/sortQ.html">sortQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span><span class="op">)</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span><span class="op">)</span>
<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span>,nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-34-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 10: <em>Nine runs with K from 2 to 4 before and after alignment.</em></p>
<p><code><a href="../reference/alignK.html">alignK()</a></code> first aligns all runs within each K and then progressively aligns pairs of K from lowest to the highest. Cluster align within K is performed using the <strong>stephens</strong> algorithm implemented in the R package <a href="https://cran.r-project.org/web/packages/label.switching/index.html">label.switching</a>. See references at bottom of this document for label.switching<sup>9</sup>. Aligning across K is carried out using the idea implemented in CLUMPAK<sup>10</sup>. If you wish to use the software CLUMPP for aligning clusters, see the section CLUMPP under Legacy.</p>
</div>
</div>
<div id="plotting" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting" class="anchor"></a>Plotting</h1>
<div id="plotq" class="section level2">
<h2 class="hasAnchor">
<a href="#plotq" class="anchor"></a>plotQ</h2>
<p>The function <code><a href="../reference/plotQ.html">plotQ()</a></code> is used to create stacked assignment barplots from a ‘qlist’. All individuals are shown on a single row. A schematic of the plot parts is shown below.</p>
<div class="figure">
<img src="figures/plotq-overview.png" alt=""><p class="caption">plotq-overview</p>
</div>
<p><b>Fig. </b> 11: <em>An overview of the components of a <code><a href="../reference/plotQ.html">plotQ()</a></code> figure and most of the arguments used to modify them.</em></p>
<p>The full code used to create the above figure is shown below. Details are explained further on.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/structure"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>, full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">slist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">sfiles</span>,indlabfromfile<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">threelabset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/metadata.txt"</span>, package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>, header<span class="op">=</span><span class="cn">T</span>,stringsAsFactors<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="va">twolabset</span> <span class="op">&lt;-</span> <span class="va">threelabset</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>

<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,showindlab<span class="op">=</span><span class="cn">T</span>,grplab<span class="op">=</span><span class="va">twolabset</span>,
      subsetgrp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Brazil"</span>,<span class="st">"Greece"</span><span class="op">)</span>,selgrp<span class="op">=</span><span class="st">"loc"</span>,ordergrp<span class="op">=</span><span class="cn">T</span>,showlegend<span class="op">=</span><span class="cn">T</span>,
      showtitle<span class="op">=</span><span class="cn">T</span>,showsubtitle<span class="op">=</span><span class="cn">T</span>,titlelab<span class="op">=</span><span class="st">"The Great Structure"</span>,
      subtitlelab<span class="op">=</span><span class="st">"The amazing population structure of your favourite organism."</span>,
      height<span class="op">=</span><span class="fl">1.6</span>,indlabsize<span class="op">=</span><span class="fl">2.3</span>,indlabheight<span class="op">=</span><span class="fl">0.08</span>,indlabspacer<span class="op">=</span><span class="op">-</span><span class="fl">1</span>,
      barbordercolour<span class="op">=</span><span class="st">"white"</span>,barbordersize<span class="op">=</span><span class="fl">0</span>,outputfilename<span class="op">=</span><span class="st">"plotq"</span>,imgtype<span class="op">=</span><span class="st">"png"</span>,
      exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>To export plots, the argument <code>exportplot=TRUE</code> must be set and the output path must be explicitly specified like <code>exportpath="./some_directory/"</code>. To use the current working directory, you can use <code>exportpath=getwd()</code>.</p>
<div id="separate-and-joined-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#separate-and-joined-plots" class="anchor"></a>Separate and Joined plots</h3>
<p>The <code>imgoutput</code> argument is used to indicate if multiple runs must be plotted as separate plots or as a joined plot. When <code>imgoutput="sep"</code>, each run file is plotted and exported as separate figures. When <code>imgoutput="join"</code>, all selected run files are plotted as a single figure and exported. Default is set as <code>imgoutput="sep"</code>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot first run separately</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co"># plot multiple runs separately</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># same as above</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, imgoutput<span class="op">=</span><span class="st">"sep"</span>,exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co"># join files into one figure</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">sfiles</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, imgoutput<span class="op">=</span><span class="st">"join"</span>,exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>For the purpose of this document, we will use a short dataset with 29 individuals. The plot is designed for export, therefore, a few arguments need to be modified.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># creating a short dataset</span>
<span class="va">slist1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">20</span><span class="op">:</span><span class="fl">25</span>,<span class="fl">50</span><span class="op">:</span><span class="fl">55</span>,<span class="fl">100</span><span class="op">:</span><span class="fl">105</span>,<span class="fl">130</span><span class="op">:</span><span class="fl">135</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>

<span class="co"># normal usage</span>
<span class="co"># p &lt;- plotQ(slist1[1])</span>
<span class="co"># modified for this document</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-37-1.svg" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 12: <em>Single run plotted separately.</em></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-38-1.svg" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 13: <em>Two runs joined together in one image.</em></p>
<p>The spacing between panels in a ‘join’ plot can be adjusted using <code>panelspacer</code>.</p>
</div>
<div id="strip-panel" class="section level3">
<h3 class="hasAnchor">
<a href="#strip-panel" class="anchor"></a>Strip panel</h3>
<p>The panel on the right side of the plot is the strip panel. The strip panel is displayed by default (<code>showsp=T</code>). The strip panel shows labels referred to as the strip labels or strip panel labels. The strip panel by default shows the filename and the <em>K</em> value. Strip panel label can be changed to show custom labels or the panel can be turned off altogether. If custom labels are provided, they must be equal to the number of runs.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># turn off strip panel</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, showsp<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="co"># move strip panel to the left</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, sppos<span class="op">=</span><span class="st">"left"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, imgoutput<span class="op">=</span><span class="st">"join"</span>, sppos<span class="op">=</span><span class="st">"left"</span><span class="op">)</span>
<span class="co"># custom strip panel label showing filename only</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, splab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>

<span class="co"># custom strip panel label showing k only</span>
<span class="va">fn1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">x</span>,<span class="st">"k"</span><span class="op">)</span>
<span class="va">spnames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"K="</span>,<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist1</span>,<span class="va">fn1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, splab<span class="op">=</span><span class="va">spnames</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>

<span class="co"># two-line strip panel label</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, splab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,<span class="st">"\n"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"run1"</span>,<span class="st">"run2"</span>,<span class="st">"run3"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, imgoutput<span class="op">=</span><span class="st">"join"</span>,
      splab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,<span class="st">"\n"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"run1"</span>,<span class="st">"run2"</span>,<span class="st">"run3"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># change colour of strip label on plot</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, splabcol<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span>
<span class="co"># change size of strip label on plot</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, splabsize<span class="op">=</span><span class="fl">7</span><span class="op">)</span>
<span class="co"># change font face of strip label on plot</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, splabface<span class="op">=</span><span class="st">"bold"</span><span class="op">)</span>
<span class="co"># hide strip label on plot</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, splabcol<span class="op">=</span><span class="st">"white"</span><span class="op">)</span>
<span class="co"># change strip panel background colour</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, spbgcol<span class="op">=</span><span class="st">"coral"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
           sppos<span class="op">=</span><span class="st">"left"</span>,splabcol<span class="op">=</span><span class="st">"red"</span>,spbgcol<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
           sppos<span class="op">=</span><span class="st">"left"</span>,splabcol<span class="op">=</span><span class="st">"red"</span>,spbgcol<span class="op">=</span><span class="st">"grey"</span>,splab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"This one"</span>,<span class="st">"That one"</span><span class="op">)</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-40-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 14: <em>Modifications to the strip panel shown on ‘sep’ plot (left) and ‘join’ plot (right).</em></p>
</div>
<div id="cluster-colours" class="section level3">
<h3 class="hasAnchor">
<a href="#cluster-colours" class="anchor"></a>Cluster colours</h3>
<p>Each cluster gets a distinct colour. Up to 12 clusters get colours assigned from a pre-defined palette which was creted for this package. I arbitrary call this the ‘standard’ colours. Clusters &gt;12 get colours derived from the function <code>rich.colors()</code> from package <code>gplots</code>. The colours can also be manually supplied to <code>clustercol</code> as a character of R colours or hexadecimal values. The length of colours must be equal to the maximum <em>K</em> value in the runs provided.</p>
<p>Examples of how to provide custom colours.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># change colour of clusters</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, imgoutput<span class="op">=</span><span class="st">"join"</span>,
    clustercol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"coral"</span>,<span class="st">"steelblue"</span>,<span class="st">"lightblue"</span>,<span class="st">"purple"</span>,<span class="st">"orange"</span><span class="op">)</span>,
    exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">16</span><span class="op">:</span><span class="fl">17</span><span class="op">]</span>, imgoutput<span class="op">=</span><span class="st">"join"</span>,
    clustercol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#A6CEE3"</span>, <span class="st">"#3F8EAA"</span>, <span class="st">"#79C360"</span>, <span class="st">"#E52829"</span>, <span class="st">"#FDB762"</span>,<span class="st">"#ED8F47"</span>,<span class="st">"#9471B4"</span><span class="op">)</span>,
    exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Here are the default colours used.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">clist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
<span class="st">"standard_12"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#2121D9"</span>,<span class="st">"#9999FF"</span>,<span class="st">"#DF0101"</span>,<span class="st">"#04B404"</span>,<span class="st">"#FFFB23"</span>,<span class="st">"#FF9326"</span>,<span class="st">"#A945FF"</span>,<span class="st">"#0089B2"</span>,<span class="st">"#B26314"</span>,<span class="st">"#610B5E"</span>,<span class="st">"#FE2E9A"</span>,<span class="st">"#BFF217"</span><span class="op">)</span>,
<span class="st">"rich.colors"</span><span class="op">=</span><span class="fu">pophelper</span><span class="fu">:::</span><span class="fu">getColours</span><span class="op">(</span><span class="fl">13</span><span class="op">)</span><span class="op">)</span>

<span class="co"># add length of palettes</span>
<span class="va">lengths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">clist</span>,<span class="va">length</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">4.5</span>,<span class="fl">0.2</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">clist</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">clist</span><span class="op">)</span><span class="op">)</span>
<span class="op">{</span>
  <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">lengths</span><span class="op">)</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">clist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"white"</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">lengths</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">clist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,axes<span class="op">=</span><span class="cn">F</span>,border<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x<span class="op">=</span><span class="op">-</span><span class="fl">0.1</span>,y<span class="op">=</span><span class="fl">0.5</span>,adj<span class="op">=</span><span class="fl">1</span>,label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">clist</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,xpd<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-42-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 15: <em>(A) Top: Colour palette used when K&lt;=12. (B) Bottom: Colour function used when K&gt;12.</em></p>
<p>Here are some more colours to play with.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">clist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
<span class="st">"shiny"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#1D72F5"</span>,<span class="st">"#DF0101"</span>,<span class="st">"#77CE61"</span>, <span class="st">"#FF9326"</span>,<span class="st">"#A945FF"</span>,<span class="st">"#0089B2"</span>,<span class="st">"#FDF060"</span>,<span class="st">"#FFA6B2"</span>,<span class="st">"#BFF217"</span>,<span class="st">"#60D5FD"</span>,<span class="st">"#CC1577"</span>,<span class="st">"#F2B950"</span>,<span class="st">"#7FB21D"</span>,<span class="st">"#EC496F"</span>,<span class="st">"#326397"</span>,<span class="st">"#B26314"</span>,<span class="st">"#027368"</span>,<span class="st">"#A4A4A4"</span>,<span class="st">"#610B5E"</span><span class="op">)</span>,
<span class="st">"strong"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#11A4C8"</span>,<span class="st">"#63C2C5"</span>,<span class="st">"#1D4F9F"</span>,<span class="st">"#0C516D"</span>,<span class="st">"#2A2771"</span>,<span class="st">"#396D35"</span>,<span class="st">"#80C342"</span>,<span class="st">"#725DA8"</span>,<span class="st">"#B62025"</span>,<span class="st">"#ED2224"</span>,<span class="st">"#ED1943"</span>,<span class="st">"#ED3995"</span>,<span class="st">"#7E277C"</span>,<span class="st">"#F7EC16"</span>,<span class="st">"#F8941E"</span>,<span class="st">"#8C2A1C"</span>,<span class="st">"#808080"</span><span class="op">)</span>,
<span class="st">"oceanfive"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#00A0B0"</span>, <span class="st">"#6A4A3C"</span>, <span class="st">"#CC333F"</span>, <span class="st">"#EB6841"</span>, <span class="st">"#EDC951"</span><span class="op">)</span>,
<span class="st">"keeled"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#48B098"</span>, <span class="st">"#91CB62"</span>, <span class="st">"#FFEE3B"</span>, <span class="st">"#FB9013"</span>, <span class="st">"#FF3C28"</span><span class="op">)</span>,
<span class="st">"vintage"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#400F13"</span>, <span class="st">"#027368"</span>, <span class="st">"#A3BF3F"</span>, <span class="st">"#F2B950"</span>, <span class="st">"#D93A2B"</span><span class="op">)</span>,
<span class="st">"muted"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#46BDDD"</span>,<span class="st">"#82DDCE"</span>,<span class="st">"#F5F06A"</span>,<span class="st">"#F5CC6A"</span>,<span class="st">"#F57E6A"</span><span class="op">)</span>,
<span class="st">"teal"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#CFF09E"</span>,<span class="st">"#A8DBA8"</span>,<span class="st">"#79BD9A"</span>,<span class="st">"#3B8686"</span>,<span class="st">"#0B486B"</span><span class="op">)</span>,
<span class="st">"merry"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#5BC0EB"</span>,<span class="st">"#FDE74C"</span>,<span class="st">"#9BC53D"</span>,<span class="st">"#E55934"</span>,<span class="st">"#FA7921"</span><span class="op">)</span>,
<span class="st">"funky"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#A6CEE3"</span>, <span class="st">"#3F8EAA"</span>, <span class="st">"#79C360"</span>, <span class="st">"#E52829"</span>, <span class="st">"#FDB762"</span>,<span class="st">"#ED8F47"</span>,<span class="st">"#9471B4"</span><span class="op">)</span>,
<span class="st">"retro"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#01948E"</span>,<span class="st">"#A9C4E2"</span>,<span class="st">"#E23560"</span>,<span class="st">"#01A7B3"</span>,<span class="st">"#FDA963"</span>,<span class="st">"#323665"</span>,<span class="st">"#EC687D"</span><span class="op">)</span>,
<span class="st">"cb_paired"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#A6CEE3"</span>,<span class="st">"#1F78B4"</span>,<span class="st">"#B2DF8A"</span>,<span class="st">"#33A02C"</span>,<span class="st">"#FB9A99"</span>,<span class="st">"#E31A1C"</span>,<span class="st">"#FDBF6F"</span>,<span class="st">"#FF7F00"</span>,<span class="st">"#CAB2D6"</span>,<span class="st">"#6A3D9A"</span>,<span class="st">"#FFFF99"</span>,<span class="st">"#B15928"</span><span class="op">)</span>,
<span class="st">"cb_set3"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#8DD3C7"</span>,<span class="st">"#FFFFB3"</span>,<span class="st">"#BEBADA"</span>,<span class="st">"#FB8072"</span>,<span class="st">"#80B1D3"</span>,<span class="st">"#FDB462"</span>,<span class="st">"#B3DE69"</span>,<span class="st">"#FCCDE5"</span>,<span class="st">"#D9D9D9"</span>,<span class="st">"#BC80BD"</span>,<span class="st">"#CCEBC5"</span>,<span class="st">"#FFED6F"</span><span class="op">)</span>,
<span class="st">"morris"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#4D94CC"</span>,<span class="st">"#34648A"</span>,<span class="st">"#8B658A"</span>,<span class="st">"#9ACD32"</span>,<span class="st">"#CC95CC"</span>,<span class="st">"#9ACD32"</span>,<span class="st">"#8B3A39"</span>,<span class="st">"#CD6601"</span>,<span class="st">"#CC5C5B"</span>,<span class="st">"#8A4500"</span><span class="op">)</span>,
<span class="st">"wong"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#000000"</span>,<span class="st">"#E69F00"</span>,<span class="st">"#56B4E9"</span>,<span class="st">"#009E73"</span>,<span class="st">"#F0E442"</span>,<span class="st">"#006699"</span>,<span class="st">"#D55E00"</span>,<span class="st">"#CC79A7"</span><span class="op">)</span>,
<span class="st">"krzywinski"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#006E82"</span>,<span class="st">"#8214A0"</span>,<span class="st">"#005AC8"</span>,<span class="st">"#00A0FA"</span>,<span class="st">"#FA78FA"</span>,<span class="st">"#14D2DC"</span>,<span class="st">"#AA0A3C"</span>,<span class="st">"#FA7850"</span>,<span class="st">"#0AB45A"</span>,<span class="st">"#F0F032"</span>,<span class="st">"#A0FA82"</span>,<span class="st">"#FAE6BE"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># add length of palettes</span>
<span class="va">lengths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">clist</span>,<span class="va">length</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">clist</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">clist</span><span class="op">)</span>,<span class="st">"_"</span>,<span class="va">lengths</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">6</span>,<span class="fl">0.2</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">clist</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">clist</span><span class="op">)</span><span class="op">)</span>
<span class="op">{</span>
  <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">lengths</span><span class="op">)</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">clist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"white"</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">lengths</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">clist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,axes<span class="op">=</span><span class="cn">F</span>,border<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x<span class="op">=</span><span class="op">-</span><span class="fl">0.1</span>,y<span class="op">=</span><span class="fl">0.5</span>,adj<span class="op">=</span><span class="fl">1</span>,label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">clist</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,xpd<span class="op">=</span><span class="cn">T</span>,cex<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span><span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-43-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">kelly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#F2F3F4"</span>,<span class="st">"#222222"</span>,<span class="st">"#F3C300"</span>,<span class="st">"#875692"</span>,<span class="st">"#F38400"</span>,<span class="st">"#A1CAF1"</span>,<span class="st">"#BE0032"</span>,<span class="st">"#C2B280"</span>,<span class="st">"#848482"</span>,<span class="st">"#008856"</span>,<span class="st">"#E68FAC"</span>,<span class="st">"#0067A5"</span>,<span class="st">"#F99379"</span>,<span class="st">"#604E97"</span>,<span class="st">"#F6A600"</span>,<span class="st">"#B3446C"</span>,<span class="st">"#DCD300"</span>,<span class="st">"#882D17"</span>,<span class="st">"#8DB600"</span>, <span class="st">"#654522"</span>,<span class="st">"#E25822"</span>,<span class="st">"#2B3D26"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">4.5</span>,<span class="fl">0.2</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">11</span><span class="op">)</span>,col<span class="op">=</span><span class="va">kelly</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">]</span>,axes<span class="op">=</span><span class="cn">F</span>,border<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span>x<span class="op">=</span><span class="op">-</span><span class="fl">0.1</span>,y<span class="op">=</span><span class="fl">0.5</span>,adj<span class="op">=</span><span class="fl">1</span>,label<span class="op">=</span><span class="st">"kelly_22"</span>,xpd<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">11</span><span class="op">)</span>,col<span class="op">=</span><span class="va">kelly</span><span class="op">[</span><span class="fl">12</span><span class="op">:</span><span class="fl">22</span><span class="op">]</span>,axes<span class="op">=</span><span class="cn">F</span>,border<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">}</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-44-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 16: <em>Examples of a few custom colour palettes. Shows name and the number of colours in the palette.</em></p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
           clustercol<span class="op">=</span><span class="va">clist</span><span class="op">$</span><span class="va">shiny</span>,splab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"K="</span>,<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span>,<span class="va">ncol</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-45-1.svg" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 17: <em>Using ‘shiny’ custom colours.</em></p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
           clustercol<span class="op">=</span><span class="va">clist</span><span class="op">$</span><span class="va">wong</span>,splab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"K="</span>,<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span>,<span class="va">ncol</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-46-1.svg" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 18: <em>Using ‘wong’ custom colours.</em></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
           clustercol<span class="op">=</span><span class="va">kelly</span>,splab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"K="</span>,<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span>,<span class="va">ncol</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">clist</span>,<span class="va">lengths</span>,<span class="va">kelly</span><span class="op">)</span>
<span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-47-1.svg" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 19: <em>Using ‘kelly’ custom colours.</em></p>
<p>Except for the ‘standard’ and ‘shiny’ colours, none of the palettes are created by myself. Please cite the relevant source if you use them.</p>
<p><b>Tab. </b> 7: <em>Colour palettes and sources.</em></p>
<table class="table">
<thead><tr class="header">
<th>Palette</th>
<th>Num of colours</th>
<th>Source</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>standard</td>
<td>12</td>
<td>This package</td>
</tr>
<tr class="even">
<td>rich.colors</td>
<td>Any</td>
<td><a href="https://cran.r-project.org/web/packages/gplots/index.html">gplots</a></td>
</tr>
<tr class="odd">
<td>shiny</td>
<td>19</td>
<td>This package</td>
</tr>
<tr class="even">
<td>strong</td>
<td>17</td>
<td>Missing source</td>
</tr>
<tr class="odd">
<td>oceanfive</td>
<td>5</td>
<td><a href="http://www.colourlovers.com/palette/1473/Ocean_Five">colourlovers</a></td>
</tr>
<tr class="even">
<td>keeled</td>
<td>5</td>
<td><a href="http://www.colourlovers.com/palette/1162333/Keeled">colourlovers</a></td>
</tr>
<tr class="odd">
<td>vintage</td>
<td>5</td>
<td>Missing source</td>
</tr>
<tr class="even">
<td>muted</td>
<td>5</td>
<td>Missing source</td>
</tr>
<tr class="odd">
<td>teal</td>
<td>5</td>
<td><a href="http://www.colourlovers.com/palette/580974/Adrift_in_Dreams">colourlovers</a></td>
</tr>
<tr class="even">
<td>merry</td>
<td>5</td>
<td>Missing source</td>
</tr>
<tr class="odd">
<td>funky</td>
<td>7</td>
<td>Missing source</td>
</tr>
<tr class="even">
<td>retro</td>
<td>7</td>
<td>Missing source</td>
</tr>
<tr class="odd">
<td>cb_paired</td>
<td>12</td>
<td><a href="http://colorbrewer2.org/#type=qualitative&amp;scheme=Paired&amp;n=12">Colorbrewer</a></td>
</tr>
<tr class="even">
<td>cb_set3</td>
<td>12</td>
<td><a href="http://colorbrewer2.org/#type=qualitative&amp;scheme=Set3&amp;n=12">Colorbrewer</a></td>
</tr>
<tr class="odd">
<td>morris</td>
<td>10</td>
<td><a href="http://www.pnas.org/content/110/2/453.full">Morris et. al., 2012</a></td>
</tr>
<tr class="even">
<td>wong</td>
<td>8</td>
<td><a href="https://www.nature.com/articles/nmeth.1618?WT.ec_id=NMETH-201106">Wong, 2011</a></td>
</tr>
<tr class="odd">
<td>krzywinski</td>
<td>12</td>
<td><a href="http://mkweb.bcgsc.ca/colorblind/">Martin Krywinski</a></td>
</tr>
<tr class="even">
<td>tatarize</td>
<td>64</td>
<td><a href="https://stackoverflow.com/questions/33295120/how-to-generate-gif-256-colors-palette">Tatarize</a></td>
</tr>
</tbody>
</table>
<p>Check out <a href="http://www.colourlovers.com/palettes">colourlovers</a>, <a href="https://coolors.co/">coolors</a>, <a href="https://color.adobe.com/explore/">Adobe colors</a>, <a href="http://colorbrewer2.org">Colorbrewer</a> etc for more colour palettes.</p>
</div>
<div id="legend" class="section level3">
<h3 class="hasAnchor">
<a href="#legend" class="anchor"></a>Legend</h3>
<p>A legend denoting colours and labels for clusters can be shown on the top of plots by setting <code>showlegend=T</code>.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># show legend</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, showlegend<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="co"># move to right side</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, showlegend<span class="op">=</span><span class="cn">T</span>, legendpos<span class="op">=</span><span class="st">"right"</span><span class="op">)</span>
<span class="co"># change legend key size</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, showlegend<span class="op">=</span><span class="cn">T</span>, legendkeysize<span class="op">=</span><span class="fl">5</span><span class="op">)</span>
<span class="co"># change legend text size</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, showlegend<span class="op">=</span><span class="cn">T</span>, legendtextsize<span class="op">=</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<p>The clusters in ‘qlist’ are by default named Cluster1, Cluster2 etc. The cluster names can be renamed by providing custom labels to argument <code>legendlab</code>. The length of <code>legendlab</code> must be equal to the max number of clusters in the selected runs.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># number of columns or K value in selected runs</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,<span class="va">ncol</span><span class="op">)</span>
<span class="co"># joined plot with custom legend labels</span>
<span class="co"># plotQ(qlist=slist[c(1,3)], imgoutput="join", showlegend=T, legendlab=c("group1","group2","group3"))</span>
<span class="co">## structure_01 structure_03 </span>
<span class="co">##            2            3</span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            showlegend<span class="op">=</span><span class="cn">T</span>, legendlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"group1"</span>,<span class="st">"group2"</span><span class="op">)</span>,
            legendkeysize<span class="op">=</span><span class="fl">10</span>,legendtextsize<span class="op">=</span><span class="fl">10</span>,legendmargin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span>,legendrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            showlegend<span class="op">=</span><span class="cn">T</span>, legendlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"group1"</span>,<span class="st">"group2"</span>,<span class="st">"group3"</span><span class="op">)</span>,
            legendkeysize<span class="op">=</span><span class="fl">10</span>,legendtextsize<span class="op">=</span><span class="fl">10</span>,legendmargin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-50-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 20: <em>(A) Left: Default legend when <code>showlegend=T</code>. (B) Right: Joined plot with custom legend labels using <code>legendlab=c('group1','group2','group3')</code>.</em></p>
</div>
<div id="y-axis" class="section level3">
<h3 class="hasAnchor">
<a href="#y-axis" class="anchor"></a>Y-axis</h3>
<p>The y-axis is turned off by default. This can be displayed using <code>showyaxis</code>. The tick marks can be displayed using <code>showticks</code>. This turns on ticks for both x and y axes.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># show y axis</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, showyaxis<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="co"># adjust size of y axis text</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, showyaxis<span class="op">=</span><span class="cn">T</span>, indlabsize<span class="op">=</span><span class="fl">6</span><span class="op">)</span>
<span class="co"># show y axis and ticks on both axes</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, showyaxis<span class="op">=</span><span class="cn">T</span>, showticks<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="co"># adjust tick size and tick length</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, showyaxis<span class="op">=</span><span class="cn">T</span>, showticks<span class="op">=</span><span class="cn">T</span>, ticksize<span class="op">=</span><span class="fl">0.3</span>, ticklength<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></code></pre></div>
<p>If y axis text overlap with a panel below, increase <code>panelspacer</code>.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            showyaxis<span class="op">=</span><span class="cn">T</span>,showticks<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            showyaxis<span class="op">=</span><span class="cn">T</span>,showticks<span class="op">=</span><span class="cn">T</span>,panelspacer<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-52-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 21: <em>Displaying y-axis labels and ticks.</em></p>
</div>
<div id="individual-labels" class="section level3">
<h3 class="hasAnchor">
<a href="#individual-labels" class="anchor"></a>Individual labels</h3>
<p>Individual labels are row names of the ‘qlist’ dataframes. Individual labels although not displayed by default on the plots, are present in the underlying data. The final individual labels in the plotted data depends on the row labels of the input data, and argument <code>useindlab</code>.</p>
<p>The default <code>useindlab=F</code>, creates labels numerically in the original order of data but with zero padding. For example, if there are 10 individuals, labels are 01, 02 up to 10. if there are 100 individuals, then labels are 001, 002 up to 100. Zero padding to ensure optimal sorting. When <code>useindlab=T</code>, labels are used from the rownames of ‘qlist’ dataframes. They are usually labelled 1,2,3.. if read in using <code><a href="../reference/readQ.html">readQ()</a></code>.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/structure"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>,full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="co"># without indlabfromfile</span>
<span class="va">slist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">sfiles</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">##   Cluster1 Cluster2</span>
<span class="co">## 1    0.965    0.035</span>
<span class="co">## 2    0.977    0.023</span>
<span class="co">## 3    0.961    0.039</span>
<span class="co">## 4    0.975    0.025</span>
<span class="co">## 5    0.974    0.026</span>
<span class="co">## 6    0.982    0.018</span></code></pre></div>
<p>This is not optimal for sorting by labels <code>sortind="label"</code>. For STRUCTURE files with individual labels, they can be read in automatically using <code><a href="../reference/readQ.html">readQ(indlabfromfile=T)</a></code>. <code>indlabfromfile</code> only works for STRUCTURE files and not for other run files.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># with useindlabfromfile</span>
<span class="va">slist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">sfiles</span>, indlabfromfile<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">##        Cluster1 Cluster2</span>
<span class="co">## I13825    0.965    0.035</span>
<span class="co">## I13826    0.977    0.023</span>
<span class="co">## I13827    0.961    0.039</span>
<span class="co">## I13828    0.975    0.025</span>
<span class="co">## I13829    0.974    0.026</span>
<span class="co">## I13830    0.982    0.018</span></code></pre></div>
<p>The rownames of ‘qlist’ can also be modified by the user by adding custom individual labels.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">inds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/structureindlabels.txt"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>,header<span class="op">=</span><span class="cn">FALSE</span>,stringsAsFactors<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="co"># add indlab to one run</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">inds</span><span class="op">$</span><span class="va">V1</span>
<span class="co"># if all runs are equal length, add indlab to all runs</span>
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="va">nrow</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="va">slist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="st">"rownames&lt;-"</span>,<span class="va">inds</span><span class="op">$</span><span class="va">V1</span><span class="op">)</span>
<span class="co"># show row names of all runs and all samples</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">slist</span>, <span class="va">rownames</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></code></pre></div>
<p>Individual labels can be shown on the plot using <code>showindlab=TRUE</code>.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            showindlab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            showindlab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-56-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 22: <em>Default individual labels displayed on ‘sep’ plot (left) and ‘join’ plot (right).</em></p>
<p>In the example below, individual labels from the qlist is used.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            showindlab<span class="op">=</span><span class="cn">T</span>,useindlab<span class="op">=</span><span class="cn">T</span>,showyaxis<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            showindlab<span class="op">=</span><span class="cn">T</span>,useindlab<span class="op">=</span><span class="cn">T</span>,showyaxis<span class="op">=</span><span class="cn">T</span>,panelspacer<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-57-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 23: <em>Individual labels displayed on ‘sep’ plot (left) and ‘join’ plot (right). Labels from the qlist are used.</em></p>
<p>When using <code>imgoutput='join'</code>, a common individual label is displayed below all runs. This is because by default <code>sharedindlab=T</code>. Set <code>sharedindlab=F</code> for displaying labels under each panel. <code>sharedindlab</code> must be set to FALSE when sorting individuals. More details about this is explained below in ‘Sort individuals’.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            showindlab<span class="op">=</span><span class="cn">T</span>,useindlab<span class="op">=</span><span class="cn">T</span>,sharedindlab<span class="op">=</span><span class="cn">F</span>,showyaxis<span class="op">=</span><span class="cn">T</span>,showticks<span class="op">=</span><span class="cn">T</span>,indlabcol<span class="op">=</span><span class="st">"coral"</span>,
            indlabangle<span class="op">=</span><span class="fl">45</span>,indlabvjust<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-58-1.svg" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 24: <em>Individual labels displayed under each panel of a ‘join’ plot. Y axis and ticks are also displayed. Some adjustments to the labels are also shown.</em></p>
<p>The spacing between the panel and individual labels can be controlled using <code>indlabspacer</code>. The height of the individual label area is controlled by <code>indlabheight</code>. When group labels (<code>grplab</code>) are in use, they can be concatenated to the individual labels. More details are explained below in ‘Sort individuals’ and ‘Group labels’.</p>
</div>
<div id="sort-individuals" class="section level3">
<h3 class="hasAnchor">
<a href="#sort-individuals" class="anchor"></a>Sort individuals</h3>
<p>Individuals in a plot are by default plotted in the order as in the input data. The individuals can be sorted based on the value of any one of the clusters (‘Cluster1’), ‘all’ or ‘label’. The ‘all’ option produces a sort similar to that in the software STRUCTURE. All clusters are taken into account to sort individuals. When using the name of a cluster, like ‘Cluster1’, ‘Cluster2’ etc, all individuals are sorted by value of the specified cluster.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># sorted by cluster 1</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, sortind<span class="op">=</span><span class="st">"Cluster1"</span><span class="op">)</span>
<span class="co"># sorted by cluster 2</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, sortind<span class="op">=</span><span class="st">"Cluster2"</span><span class="op">)</span>
<span class="co"># sorted by all</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, sortind<span class="op">=</span><span class="st">"all"</span><span class="op">)</span>

<span class="co"># sorted by cluster 3</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, sortind<span class="op">=</span><span class="st">"Cluster3"</span><span class="op">)</span> <span class="co"># gives error because this file contains only 2 clusters</span>

<span class="co"># sorted by cluster 1, three files joined plot</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, sortind<span class="op">=</span><span class="st">"Cluster1"</span>, imgoutput<span class="op">=</span><span class="st">"join"</span>,sharedindlab<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, sortind<span class="op">=</span><span class="st">"all"</span>, imgoutput<span class="op">=</span><span class="st">"join"</span>,sharedindlab<span class="op">=</span><span class="cn">F</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            sortind<span class="op">=</span><span class="st">"Cluster1"</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            sortind<span class="op">=</span><span class="st">"Cluster1"</span>,sharedindlab<span class="op">=</span><span class="cn">F</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-60-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 25: <em>(A) Left: ‘sep’ plot sorted by ‘Cluster1’. (B) Right: ‘join’ plot sorted by ‘Cluster1’.</em></p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            sortind<span class="op">=</span><span class="st">"all"</span>,showindlab<span class="op">=</span><span class="cn">T</span>,showyaxis<span class="op">=</span><span class="cn">T</span>,showticks<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            sortind<span class="op">=</span><span class="st">"all"</span>,sharedindlab<span class="op">=</span><span class="cn">F</span>,showindlab<span class="op">=</span><span class="cn">T</span>,showyaxis<span class="op">=</span><span class="cn">T</span>,showticks<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-61-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 26: <em>(A) Left: ‘sep’ plot sorted by ‘all’. (B) Right: ‘join’ plot sorted by ‘all’. Individual labels and y-axis is displayed.</em></p>
<p>When using <code>sortind="label"</code>, individuals are sorted by individual labels. Individuals are labelled numerically padded with zeros when <code>useindlab=F</code>. Labels are taken from the qlist when <code>useindlab=T</code>.</p>
</div>
<div id="group-labels" class="section level3">
<h3 class="hasAnchor">
<a href="#group-labels" class="anchor"></a>Group labels</h3>
<p>One or more sets of group labels can be added to the bottom of barplots by providing a ‘data.frame’ object. The number of rows of the ‘data.frame’ must be equal to the number of individuals. The header of the ‘data.frame’ is the group label set title.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># group labels with one group label set</span>
<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>lab1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># group labels with two group label sets</span>
<span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>type<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"B"</span><span class="op">)</span>,loc<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Brazil"</span>,<span class="st">"Brazil"</span>,<span class="st">"Chile"</span>,<span class="st">"Chile"</span>,<span class="st">"Chile"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>In this demonstration, we will use group labels in the <code>pophelper</code> library. This is a ‘data.frame’ with three columns, ie; three group label sets.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">slist1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">20</span><span class="op">:</span><span class="fl">25</span>,<span class="fl">50</span><span class="op">:</span><span class="fl">55</span>,<span class="fl">100</span><span class="op">:</span><span class="fl">105</span>,<span class="fl">130</span><span class="op">:</span><span class="fl">135</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>

<span class="co"># read labels for STRUCTURE runs</span>
<span class="va">threelabset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/metadata.txt"</span>, package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>, header<span class="op">=</span><span class="cn">T</span>,stringsAsFactors<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">threelabset</span><span class="op">)</span>
<span class="co"># length of labels equal to number of individuals?</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">threelabset</span><span class="op">)</span>
<span class="co"># check if labels are a character data type</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">threelabset</span>, <span class="va">is.character</span><span class="op">)</span>

<span class="co"># create short set to match slist1</span>
<span class="va">onelabset</span> <span class="op">&lt;-</span> <span class="va">threelabset</span><span class="op">[</span>,<span class="fl">2</span>,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>
<span class="va">threelabset1</span> <span class="op">&lt;-</span> <span class="va">threelabset</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">20</span><span class="op">:</span><span class="fl">25</span>,<span class="fl">50</span><span class="op">:</span><span class="fl">55</span>,<span class="fl">100</span><span class="op">:</span><span class="fl">105</span>,<span class="fl">130</span><span class="op">:</span><span class="fl">135</span><span class="op">)</span>,<span class="op">]</span>
<span class="va">twolabset1</span> <span class="op">&lt;-</span> <span class="va">threelabset1</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>
<span class="co">##       type  cat    loc</span>
<span class="co">## 1 Tropical CatA Panama</span>
<span class="co">## 2 Tropical CatA Panama</span>
<span class="co">## 3 Tropical CatA Panama</span>
<span class="co">## 4 Tropical CatA Panama</span>
<span class="co">## 5 Tropical CatA Panama</span>
<span class="co">## 6 Tropical CatA Panama</span>
<span class="co">## [1] 149</span>
<span class="co">## type  cat  loc </span>
<span class="co">## TRUE TRUE TRUE</span></code></pre></div>
<p>Make sure that the labels are character datatype. When reading from a text file, use <code>stringsAsFactors=F</code> to ensure that each column in the dataframe is a character and not a factor. From the above label dataframe, we can choose to use one label set or multiple.</p>
<p>For now we use a single label set. Note the use of <code>drop=FALSE</code> to preserve the single label set as a ‘data.frame’.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">onelabset1</span> <span class="op">&lt;-</span> <span class="va">threelabset1</span><span class="op">[</span>,<span class="fl">2</span>,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">onelabset1</span><span class="op">)</span>
<span class="co">#plotQ(qlist=slist[1], grplab=threelabset, outputfilename="structure-single-grplab")</span>
<span class="co">##     cat</span>
<span class="co">## 1  CatA</span>
<span class="co">## 2  CatA</span>
<span class="co">## 3  CatA</span>
<span class="co">## 4  CatA</span>
<span class="co">## 5  CatA</span>
<span class="co">## 20 CatA</span></code></pre></div>
<p>The group labels panel has the text labels, horizontal lines called marker lines and marker line divisions called marker points. Many aspects of these can be adjusted. For marker lines, the line position, line thickness, line type and line colour can be adjusted. For marker points, the point position, point type, point size and point colour can be adjusted.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">4</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">4</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">4</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">4</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-65-1.svg" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 27: <em>Barplot with one group label set. ‘sep’ plot (top) and ‘join’ plot (bottom).</em></p>
<p>The group label set title or the header of the group label ‘data.frame’ is shown on the right strip panel. Individual labels can be displayed along with group labels.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,
            showindlab<span class="op">=</span><span class="cn">T</span>,grplabface<span class="op">=</span><span class="st">"italic"</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,
            basesize<span class="op">=</span><span class="fl">11</span>,grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,
            showindlab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-66-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 28: <em>Barplot with one group label set. ‘sep’ plot (left) and ‘join’ plot (right). Individual labels are also displayed</em></p>
<p>When group labels are in use (<code>grplab</code>), they can be concatenated to the individual labels in both cases <code>useindlab=T</code> and <code>useindlab=F</code>, separated by <code>indlabsep</code>. Default <code>indlabsep=" "</code> adds a space between individual label and grplab. For example, group labels ‘popA’, ‘popA’… will be ‘01 popA’, ‘02 popA’… when <code>useindlab=F</code> and usually ‘1 popA’, ‘2 popA’… when <code>useindlab=T</code>. When multiple group labels are in use, the are similarly concatenated one after the other to individual names in the order in which the group labels were provided.</p>
<p>Group labels can be concatenated to the individual labels using the argument <code>indlabwithgrplab=T</code>. The absolute height of the group label panel is controlled with <code>grplabheight</code>. The ratio of the plot panels and group label panel is controlled with <code>panelratio</code>. The default <code>panelratio</code> is 3:1.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,
            showindlab<span class="op">=</span><span class="cn">T</span>,indlabwithgrplab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,
            showindlab<span class="op">=</span><span class="cn">T</span>,indlabwithgrplab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-67-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 29: <em>Barplot with one group label set. Group labels are concatenated to the individual labels. ‘sep’ plot (left) and ‘join’ plot (right). </em></p>
<p>The individual labels take up most of the plot area. The group labels take up a lot of space on the top plot. The total plot height can be increased and the panel ratio needs to be adjusted.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,
            showindlab<span class="op">=</span><span class="cn">T</span>,indlabwithgrplab<span class="op">=</span><span class="cn">T</span>,panelratio<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,
            showindlab<span class="op">=</span><span class="cn">T</span>,indlabwithgrplab<span class="op">=</span><span class="cn">T</span>,panelratio<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-68-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 30: <em>Barplot with one group label set and concatenated individual labels as well as corrected panel ratio. ‘sep’ plot (left) and ‘join’ plot (right).</em></p>
<p>The group labels can be hidden by setting <code>showgrplab=F</code>.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,panelratio<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span>,showgrplab<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-69-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 31: <em>Group labels are used but not displayed.</em></p>
</div>
<div id="sorting-with-group-labels" class="section level3">
<h3 class="hasAnchor">
<a href="#sorting-with-group-labels" class="anchor"></a>Sorting with group labels</h3>
<p>When individuals can be sorted while using group labels, they are sorted within their groups.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,
            sortind<span class="op">=</span><span class="st">"Cluster1"</span>,panelratio<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,
            sharedindlab<span class="op">=</span><span class="cn">F</span>,sortind<span class="op">=</span><span class="st">"all"</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-70-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 32: <em>Sorting of individuals with group labels. Note that sorting happens within the selected group label set. ‘sep’ plot (left) showing sorting by ‘Cluster1’ and ‘join’ plot (right) showing sorting by ‘all’.</em></p>
<p>Turning on individual labels help to identify individuals. Shown for ‘join’ plot below.</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">4</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,
            sharedindlab<span class="op">=</span><span class="cn">F</span>,sortind<span class="op">=</span><span class="st">"all"</span>,showindlab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-71-1.svg" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 33: <em>Sorting of individuals with group labels in a ‘join’ plot. Individual labels are displayed under each subplot. The individual label reflects how samples were sorted from their original order.</em></p>
<p>Sorting by <code>label</code> sorts all individuals by the individual label. Since this is same across all runs and K, a shared individual label is possible when <code>imgoutput="join"</code>. If group labels are concatenated to the individual labels, the full concatenated string will determine the final sort order of the individuals. See previous section ‘Individual labels’ and ‘Sort individuals’ for more information.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,
            sharedindlab<span class="op">=</span><span class="cn">T</span>,sortind<span class="op">=</span><span class="st">"label"</span>,showindlab<span class="op">=</span><span class="cn">T</span>,useindlab<span class="op">=</span><span class="cn">F</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,
            sharedindlab<span class="op">=</span><span class="cn">T</span>,sortind<span class="op">=</span><span class="st">"label"</span>,showindlab<span class="op">=</span><span class="cn">T</span>,useindlab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-72-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 34: <em>Sorting of individuals with group labels in a ‘join’ plot. Both plots are sorted by ‘label’ Left plot uses default individual labels (<code>useindlab=F</code>) while the right plot uses individual labels from the qlist (<code>useindlab=T</code>). Note the difference in sorting order.</em></p>
<p>Shared labelling between runs is possible only when unsorted or sorting by ‘label’. When sorting by ‘all’ or a cluster, each run may have a different sort order and a shared common label is not possible.</p>
</div>
<div id="subsetreorder-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetreorder-groups" class="anchor"></a>Subset/reorder groups</h3>
<p>When using group labels, the plot can be subsetted or reordered based on group labels. Below are examples using group labels with single group label set.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># subsetting groups</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">onelabset</span>, subsetgrp<span class="op">=</span><span class="st">"CatB"</span><span class="op">)</span>
<span class="co"># change order of groups</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">onelabset</span>, subsetgrp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CatB"</span>,<span class="st">"CatA"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># subsetting group and sorting individuals</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">onelabset</span>, subsetgrp<span class="op">=</span><span class="st">"CatB"</span>,sortind<span class="op">=</span><span class="st">"Cluster1"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">onelabset</span>, subsetgrp<span class="op">=</span><span class="st">"CatA"</span>,sortind<span class="op">=</span><span class="st">"all"</span><span class="op">)</span>

<span class="co"># change order of groups and sorting individuals</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">onelabset</span>, subsetgrp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CatB"</span>,<span class="st">"CatA"</span><span class="op">)</span>, sortind<span class="op">=</span><span class="st">"Cluster1"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">onelabset</span>, subsetgrp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CatB"</span>,<span class="st">"CatA"</span><span class="op">)</span>,
      sharedindlab<span class="op">=</span><span class="cn">F</span>, sortind<span class="op">=</span><span class="st">"all"</span>, imgoutput<span class="op">=</span><span class="st">"join"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            subsetgrp<span class="op">=</span><span class="st">"CatB"</span><span class="op">)</span>

<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            subsetgrp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CatB"</span>,<span class="st">"CatA"</span><span class="op">)</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p3</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-74-1.svg" width="960" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 35: <em>‘join’ plots showing subsetting and reordering using group labels. Left shows a ‘join’ plot with one group label set. Middle shows subset on ‘CatB’. Right shows reordering ‘CatB’ and ‘CatA’. Individual labels are displayed to show change in positions.</em></p>
<p>We can also sort along with subset and reordering.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            subsetgrp<span class="op">=</span><span class="st">"CatA"</span>,sortind<span class="op">=</span><span class="st">"Cluster1"</span>,sharedindlab<span class="op">=</span><span class="cn">F</span><span class="op">)</span>

<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            subsetgrp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CatB"</span>,<span class="st">"CatA"</span><span class="op">)</span>,sortind<span class="op">=</span><span class="st">"Cluster1"</span>,sharedindlab<span class="op">=</span><span class="cn">F</span><span class="op">)</span>

<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            subsetgrp<span class="op">=</span><span class="st">"CatA"</span>,sortind<span class="op">=</span><span class="st">"all"</span>,sharedindlab<span class="op">=</span><span class="cn">F</span><span class="op">)</span>

<span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            subsetgrp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CatB"</span>,<span class="st">"CatA"</span><span class="op">)</span>,sortind<span class="op">=</span><span class="st">"all"</span>,sharedindlab<span class="op">=</span><span class="cn">F</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p3</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p4</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p5</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,
             layout_matrix<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">3</span>,byrow<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-75-1.svg" width="960" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 36: <em>‘join’ plots showing subsetting and reordering using group labels and sorting. Left shows a ‘join’ plot with one group label set. Middle top shows subset on ‘CatA’ and sorted by ‘Cluster1’. Middle bottom shows subset on ‘CatA’ and sorted by ‘all’. Right top shows reorder to ‘CatB,CatA’ and sorted by ‘Cluster1’. Right bottom shows reorder to ‘CatB,CatA’ and sorted by ‘all’. Individual labels are displayed to show change in positions.</em></p>
<p>All of the above can be extended to group labels with more than one set. For more details for group labels with more than one label set, see ‘Multiple label sets’ further below.</p>
</div>
<div id="group-mean" class="section level3">
<h3 class="hasAnchor">
<a href="#group-mean" class="anchor"></a>Group mean</h3>
<p>An additional feature is the ability to plot mean values (<code>grpmean=T</code>) by group when group labels are in use.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># group mean</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">onelabset</span>, grpmean<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">al</span><span class="op">)</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, imgoutput<span class="op">=</span><span class="st">"join"</span>, grplab<span class="op">=</span><span class="va">onelabset</span>, grpmean<span class="op">=</span><span class="cn">T</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            grpmean<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            grpmean<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-77-1.svg" width="960" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 37: <em>‘sep’ and ‘join’ plots showing mean values by group (grpmean).</em></p>
</div>
<div id="order-groups" class="section level3">
<h3 class="hasAnchor">
<a href="#order-groups" class="anchor"></a>Order groups</h3>
<p>In the example group label so far, the labels were already in contiguous blocks. But, if labels are not in contiguous blocks, ie; there are duplicated non-contiguous blocks of labels, many of the options such as sorting, subsetting etc cannot be used. Below illustrates this concept.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>Contiguous block<span class="sc">:</span> A,A,A,A,B,B,C,C,C</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>Non<span class="sc">-</span>contiguous block<span class="sc">:</span> A,A,A,B,B,A,A,C,C</span></code></pre></div>
<p>Here we use a single group label set which is in non-contiguous blocks. And we plot the data.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">onelabsetrep</span> <span class="op">&lt;-</span> <span class="va">threelabset1</span><span class="op">[</span>,<span class="fl">1</span>,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>

<span class="co"># multiple blocks of duplicate labels</span>
<span class="fu"><a href="https://rdrr.io/r/base/rle.html">rle</a></span><span class="op">(</span><span class="va">onelabsetrep</span><span class="op">$</span><span class="va">type</span><span class="op">)</span><span class="op">$</span><span class="va">values</span>

<span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabsetrep</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">## [1] "Tropical"  "Temperate" "Tropical"  "Temperate" "Tropical"</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-79-1.svg" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 38: <em>Non-contiguous labels.</em></p>
<p>As seen above, Temperate appears twice and Tropical appears three times. Options such as <code>subsetgrp</code> do not work with non-contiguous blocks of labels.</p>
<pre><code>plotQ(qlist=slist1[1], grplab=onelabsetrep, subsetgrp="Tropical") #gives error

Error in pophelper:::grpLabels(dframe = df1, grplab = grplabloop, selgrp = selgrp, : grpLabels: Duplicated contiguous block of labels in 'selgrp'. Change grplab, selgrp or use 'ordergrp=TRUE'.</code></pre>
<p>Non-contiguous labels can be grouped into contiguous blocks using <code>ordergrp=TRUE</code>. When using this, the labels are sorted alphabetically along with the data. The individuals are no longer in the original order as input.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabsetrep</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            ordergrp<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-80-1.svg" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 39: <em>Non-contiguous labels ordered to contiguous blocks.</em></p>
<p>Ordered group labels can now be sorted, subsetted or reordered.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabsetrep</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            ordergrp<span class="op">=</span><span class="cn">T</span>,sortind<span class="op">=</span><span class="st">"all"</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabsetrep</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            ordergrp<span class="op">=</span><span class="cn">T</span>,subset<span class="op">=</span><span class="st">"Tropical"</span><span class="op">)</span>

<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabsetrep</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            ordergrp<span class="op">=</span><span class="cn">T</span>,subset<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Tropical"</span>,<span class="st">"Temperate"</span><span class="op">)</span><span class="op">)</span>


<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p3</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-81-1.svg" width="960" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 40: <em>Ordered grplabs used for sorting, subsetting and reordering.</em></p>
</div>
<div id="multiple-label-sets" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-label-sets" class="anchor"></a>Multiple label sets</h3>
<p>More than one set of group label sets can be be added to the plot simply by providing more columns in the <code>grplab</code> ‘data.frame’. Here is an example.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">threelabset1</span>
<span class="co">##          type  cat    loc</span>
<span class="co">## 1    Tropical CatA Panama</span>
<span class="co">## 2    Tropical CatA Panama</span>
<span class="co">## 3    Tropical CatA Panama</span>
<span class="co">## 4    Tropical CatA Panama</span>
<span class="co">## 5    Tropical CatA Panama</span>
<span class="co">## 20   Tropical CatA Panama</span>
<span class="co">## 21   Tropical CatA Panama</span>
<span class="co">## 22   Tropical CatA Panama</span>
<span class="co">## 23   Tropical CatA Panama</span>
<span class="co">## 24   Tropical CatA Panama</span>
<span class="co">## 25   Tropical CatA Panama</span>
<span class="co">## 50   Tropical CatA Panama</span>
<span class="co">## 51   Tropical CatA Panama</span>
<span class="co">## 52   Tropical CatA Panama</span>
<span class="co">## 53   Tropical CatA Panama</span>
<span class="co">## 54   Tropical CatA Panama</span>
<span class="co">## 55   Tropical CatA Panama</span>
<span class="co">## 100 Temperate CatA Greece</span>
<span class="co">## 101  Tropical CatA Panama</span>
<span class="co">## 102  Tropical CatA Panama</span>
<span class="co">## 103  Tropical CatA Panama</span>
<span class="co">## 104 Temperate CatA Greece</span>
<span class="co">## 105 Temperate CatA Greece</span>
<span class="co">## 130  Tropical CatB Brazil</span>
<span class="co">## 131  Tropical CatB Brazil</span>
<span class="co">## 132  Tropical CatB Brazil</span>
<span class="co">## 133  Tropical CatB Brazil</span>
<span class="co">## 134  Tropical CatB Brazil</span>
<span class="co">## 135  Tropical CatB Brazil</span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-83-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 41: <em>Barplot with three group label sets. ‘sep’ plot (left) and ‘join’ plot (right).</em></p>
<p>When plotting with mutiple group label sets, one group label set is defined as the selected group. This is declared using the argument <code>selgrp</code>. The value in <code>selgrp</code> must be one the group label set titles (headers in the grplab ‘data.frame’). If <code>selgrp</code> is not explicitly specified, the first group label set is taken as <code>selgrp</code>. If only one group label set is used, then <code>selgrp</code> is automatically the title of that set. <code>selgrp</code> denotes which label set is used for <code>subsetgrp</code>, <code>ordergrp</code> and <code>grpmean</code>.</p>
<p>When sorting by ‘label’, ‘all’ or a cluster, sorting occurs within group labels. <code>ordergrp=T</code> must be set when sorting in a ‘joined’ plot with multiple group labels. This orders all group labels starting with <code>selgrp</code>.</p>
<p>To illustrate this further, imagine three label sets ‘type’, ‘cat’ and ‘loc’. <code>selgrp</code> is set as <code>selgrp="cat"</code>. When sorting by ‘Cluster1’ (<code>sortind="Cluster1"</code>), the table is ordered by ‘cat’,‘type’,‘loc’ and ‘Cluster1’ in that order.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,panelratio<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">)</span>,
            selgrp<span class="op">=</span><span class="st">"cat"</span>,sortind<span class="op">=</span><span class="st">"Cluster1"</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,sharedindlab<span class="op">=</span><span class="cn">F</span>,
            selgrp<span class="op">=</span><span class="st">"cat"</span>,sortind<span class="op">=</span><span class="st">"all"</span>,ordergrp<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-84-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 42: <em>Sorting when using multiple group label sets.</em></p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,sharedindlab<span class="op">=</span><span class="cn">F</span>,
            selgrp<span class="op">=</span><span class="st">"cat"</span>,sortind<span class="op">=</span><span class="st">"all"</span>,ordergrp<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,sharedindlab<span class="op">=</span><span class="cn">F</span>,
            selgrp<span class="op">=</span><span class="st">"loc"</span>,sortind<span class="op">=</span><span class="st">"all"</span>,ordergrp<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-85-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 43: <em>Changing the selected group when sorting individuals. Left by cat and right, by loc. Both plots are sorted by ‘all’.</em></p>
<p>Subsetting and reordering works similarly when using multiple label sets.</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            subsetgrp<span class="op">=</span><span class="st">"CatB"</span>,selgrp<span class="op">=</span><span class="st">"cat"</span><span class="op">)</span>

<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            subsetgrp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CatB"</span>,<span class="st">"CatA"</span><span class="op">)</span>,selgrp<span class="op">=</span><span class="st">"cat"</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p3</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-86-1.svg" width="960" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 44: <em>Joined plots showing subsetting and reordering using group labels with three label sets. Left shows a joined plot with one group label set. Middle shows subset on ‘CatB’. Right shows reordering ‘CatB’ and ‘CatA’. Individual labels are displayed to show change in positions.</em></p>
<p>When using multiple label sets containing non-contiguous labels, <code>ordergrp</code> orders all group label sets into contiguous blocks starting with <code>selgrp</code>. This is shown in previous figures.</p>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            selgrp<span class="op">=</span><span class="st">"type"</span>,ordergrp<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            selgrp<span class="op">=</span><span class="st">"type"</span>,ordergrp<span class="op">=</span><span class="cn">T</span>,subsetgrp<span class="op">=</span><span class="st">"Temperate"</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p3</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-87-1.svg" width="960" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 45: <em>Joined plots showing ordergrp using group labels with three label sets. Left shows a joined plot with three group label sets. Group label set ‘type’ has non-contiguous labels. Middle shows the data ordered using <code>selgrp='type'</code>. Right shows subsetting ‘Temperate’ from group label set ‘type’.</em></p>
</div>
<div id="divider-line" class="section level3">
<h3 class="hasAnchor">
<a href="#divider-line" class="anchor"></a>Divider line</h3>
<p>The white dotted line dividing the groups on the plot panels when using group labels is called the divider line. By default, the divider line is drawn between groups in the first group label set (See figures above). This can be changed by providing titles of group labels to the argument <code>divgrp</code>. <code>divgrp</code> can also take more than one label set, which means divider lines can be drawn for multiple group label sets simultaneously. Divider lines can be turned off using <code>showdiv=FALSE</code>.</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,ordergrp<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,ordergrp<span class="op">=</span><span class="cn">T</span>,
            divgrp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"type"</span>,<span class="st">"cat"</span><span class="op">)</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-88-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 46: <em>(A) Left: Default divider lines for ‘type’. (B) Right: Divider lines for both group label sets ‘type’ and ‘cat’.</em></p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,
            ordergrp<span class="op">=</span><span class="cn">T</span>,sortind<span class="op">=</span><span class="st">"all"</span>,sharedindlab<span class="op">=</span><span class="cn">F</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,ordergrp<span class="op">=</span><span class="cn">T</span>,
            divgrp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"type"</span>,<span class="st">"cat"</span><span class="op">)</span>,sortind<span class="op">=</span><span class="st">"Cluster1"</span>,sharedindlab<span class="op">=</span><span class="cn">F</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-89-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 47: <em>(A) Left: Default divider lines for ‘type’ with sorting. (B) Right: Divider lines for both group label sets ‘type’ and ‘cat’ with sorting.</em></p>
<p>The divider liness can also be modified and adjusted.</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># change div colour, type and thickness</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">threelabset</span>, divcol<span class="op">=</span><span class="st">"coral"</span>, divtype<span class="op">=</span><span class="fl">1</span>, divsize<span class="op">=</span><span class="fl">0.8</span>, divalpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">threelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,showindlab<span class="op">=</span><span class="cn">T</span>,ordergrp<span class="op">=</span><span class="cn">T</span>,
            divgrp<span class="op">=</span><span class="st">"loc"</span>,divcol<span class="op">=</span><span class="st">"green"</span>,divtype<span class="op">=</span><span class="fl">4</span>,divsize<span class="op">=</span><span class="fl">1</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-91-1.svg" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 48: <em>Adjustments to the divider line.</em></p>
</div>
<div id="title-and-subtitle" class="section level3">
<h3 class="hasAnchor">
<a href="#title-and-subtitle" class="anchor"></a>Title and subtitle</h3>
<p>Title and/or subtitle can be added to separate or joined plots. Title and subtitle are displayed using <code>showtitle=T</code> and <code>showsubtitle=T</code> respectively. The file name is displayed by default. Custom label can be provided using <code>titlelab</code> or <code>subtitlelab</code>. If multiple plots are exported, then a character vector of labels equal to number of plots must be provided.</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            showtitle<span class="op">=</span><span class="cn">T</span>,showsubtitle<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            showtitle<span class="op">=</span><span class="cn">T</span>,showsubtitle<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            showtitle<span class="op">=</span><span class="cn">T</span>,showsubtitle<span class="op">=</span><span class="cn">T</span>,titlelab<span class="op">=</span><span class="st">"Structure plot"</span>,
            subtitlelab<span class="op">=</span><span class="st">"Population structure of some organism."</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p3</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,layout_matrix<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="cn">NA</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">3</span>,byrow<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-92-1.svg" width="960" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 49: <em>(A) Left: Default title and subtitle for a ‘sep’ plot. (B) Middle: Default title and subtitle for a ‘join’ plot. (C) Right: Custom title and subtitle in a ‘join’ plot.</em></p>
</div>
<div id="other-options" class="section level3">
<h3 class="hasAnchor">
<a href="#other-options" class="anchor"></a>Other options</h3>
<p><strong>Plot visual adjustments</strong></p>
<p>Examples of some of plot options that can be modified.</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># adjust label angle and justification</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">threelabset1</span>, grplabangle<span class="op">=</span><span class="op">-</span><span class="fl">90</span>, grplabjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>

<span class="co"># adjust grplabheight to fit labels</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">threelabset1</span>, grplabangle<span class="op">=</span><span class="op">-</span><span class="fl">90</span>, grplabjust<span class="op">=</span><span class="fl">0.4</span>, grplabheight<span class="op">=</span><span class="fl">3</span><span class="op">)</span>

<span class="co"># when grplabheight is high enough, use grplabpos to move labels vertically</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">threelabset1</span>, grplabheight<span class="op">=</span><span class="fl">3</span>, grplabpos<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">threelabset1</span>, grplabheight<span class="op">=</span><span class="fl">3</span>, grplabpos<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span>

<span class="co"># adjust grplabel colour</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>,grplab<span class="op">=</span><span class="va">threelabset1</span>, grplabcol<span class="op">=</span><span class="st">"green"</span><span class="op">)</span>

<span class="co"># adjust marker points</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">threelabset1</span>, pointtype<span class="op">=</span><span class="fl">21</span>, pointsize<span class="op">=</span><span class="fl">0.4</span>, pointcol<span class="op">=</span><span class="st">"steelblue"</span>, pointbgcol<span class="op">=</span><span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">threelabset1</span>, pointtype<span class="op">=</span><span class="st">"$"</span>, pointcol<span class="op">=</span><span class="st">"green"</span>, pointsize<span class="op">=</span><span class="fl">2</span><span class="op">)</span>

<span class="co"># adjust marker line</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">threelabset1</span>, linesize<span class="op">=</span><span class="fl">0.5</span>, linecol<span class="op">=</span><span class="st">"steelblue"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">threelabset1</span>, linecol<span class="op">=</span><span class="st">"steelblue"</span>, linetype<span class="op">=</span><span class="fl">3</span>, linesize<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span></code></pre></div>
<p>Multiple plot argument adjustments to obtain a new label style.</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
            grplab<span class="op">=</span><span class="va">onelabset1</span>,grplabsize<span class="op">=</span><span class="fl">3.5</span>,pointsize<span class="op">=</span><span class="fl">6</span>,linesize<span class="op">=</span><span class="fl">7</span>,linealpha<span class="op">=</span><span class="fl">0.2</span>,
            pointcol<span class="op">=</span><span class="st">"white"</span>,grplabpos<span class="op">=</span><span class="fl">0.5</span>,linepos<span class="op">=</span><span class="fl">0.5</span>,grplabheight<span class="op">=</span><span class="fl">0.75</span><span class="op">)</span>

<span class="fu">grid.arrange</span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-94-1.svg" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 50: <em>Group labels in a different style.</em></p>
<p>The argument <code>basesize</code> can be used to change text size of most text objects. This can be helpful to increase or decrease the size of all text. The default basesize is 5. Some of the elements not affected by <code>basesize</code> adjustment are <code>grplabsize</code> and <code>legendtextsize</code>.</p>
<p><strong>Exporting and returning</strong></p>
<p>By default, when plotting, an export location must be specified using <code>exportpath</code>. Exporting can be turned off by <code>exportplot=FALSE</code>. By setting <code>returnplot=TRUE</code>, the plot object can be returned and saved as a variable for plotting later or further customisation. By setting <code>returndata=TRUE</code>, the internally processed data (qlist and grplab) can be returned to be saved to a variable. The returned object is a list and has the following structure:</p>
<pre><code>$list
+--$plot
+--$data
   +--$qlist
   +--$grplab</code></pre>
<p>The plot slot consists of a list of one or more plots. If the plot was plotted without group labels, a ggplot2 object is returned. If the plot was plotted with group labels, a gtable (result of gridExtra::arrangeGrob()) is returned. The plot slot is NA if <code>returnplot=FALSE</code>. The data slot has a list of qlist and grplab. The data slot is populated only if <code>returndata=TRUE</code>. And the grplab slot is populated only if group labels were used.</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># return plot only</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span>
<span class="co">## $plot</span>
<span class="co">## $plot[[1]]</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $data</span>
<span class="co">## $data$qlist</span>
<span class="co">## [1] NA</span>
<span class="co">## </span>
<span class="co">## $data$grplab</span>
<span class="co">## [1] NA</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-95-1.svg" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p>Note that p1 has a ggplot2 plot object and the other slots are empty.</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># return plot and data (withgrplab)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returndata<span class="op">=</span><span class="cn">T</span>,grplab<span class="op">=</span><span class="va">onelabset1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span>
<span class="co">## $plot</span>
<span class="co">## $plot[[1]]</span>
<span class="co">## TableGrob (4 x 1) "arrange": 2 grobs</span>
<span class="co">##   z     cells    name           grob</span>
<span class="co">## 1 1 (1-3,1-1) arrange gtable[layout]</span>
<span class="co">## 2 2 (4-4,1-1) arrange gtable[layout]</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $data</span>
<span class="co">## $data$qlist</span>
<span class="co">## $data$qlist$structure_01</span>
<span class="co">##    Cluster1 Cluster2</span>
<span class="co">## 01    0.965    0.035</span>
<span class="co">## 02    0.977    0.023</span>
<span class="co">## 03    0.961    0.039</span>
<span class="co">## 04    0.975    0.025</span>
<span class="co">## 05    0.974    0.026</span>
<span class="co">## 06    0.963    0.037</span>
<span class="co">## 07    0.984    0.016</span>
<span class="co">## 08    0.979    0.021</span>
<span class="co">## 09    0.965    0.035</span>
<span class="co">## 10    0.823    0.177</span>
<span class="co">## 11    0.892    0.108</span>
<span class="co">## 12    0.975    0.025</span>
<span class="co">## 13    0.943    0.057</span>
<span class="co">## 14    0.922    0.078</span>
<span class="co">## 15    0.896    0.104</span>
<span class="co">## 16    0.914    0.086</span>
<span class="co">## 17    0.976    0.024</span>
<span class="co">## 18    0.275    0.725</span>
<span class="co">## 19    0.849    0.151</span>
<span class="co">## 20    0.976    0.024</span>
<span class="co">## 21    0.942    0.058</span>
<span class="co">## 22    0.648    0.352</span>
<span class="co">## 23    0.580    0.420</span>
<span class="co">## 24    0.092    0.908</span>
<span class="co">## 25    0.036    0.964</span>
<span class="co">## 26    0.025    0.975</span>
<span class="co">## 27    0.027    0.973</span>
<span class="co">## 28    0.030    0.970</span>
<span class="co">## 29    0.050    0.950</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $data$grplab</span>
<span class="co">## $data$grplab[[1]]</span>
<span class="co">##      cat</span>
<span class="co">## 1   CatA</span>
<span class="co">## 2   CatA</span>
<span class="co">## 3   CatA</span>
<span class="co">## 4   CatA</span>
<span class="co">## 5   CatA</span>
<span class="co">## 20  CatA</span>
<span class="co">## 21  CatA</span>
<span class="co">## 22  CatA</span>
<span class="co">## 23  CatA</span>
<span class="co">## 24  CatA</span>
<span class="co">## 25  CatA</span>
<span class="co">## 50  CatA</span>
<span class="co">## 51  CatA</span>
<span class="co">## 52  CatA</span>
<span class="co">## 53  CatA</span>
<span class="co">## 54  CatA</span>
<span class="co">## 55  CatA</span>
<span class="co">## 100 CatA</span>
<span class="co">## 101 CatA</span>
<span class="co">## 102 CatA</span>
<span class="co">## 103 CatA</span>
<span class="co">## 104 CatA</span>
<span class="co">## 105 CatA</span>
<span class="co">## 130 CatB</span>
<span class="co">## 131 CatB</span>
<span class="co">## 132 CatB</span>
<span class="co">## 133 CatB</span>
<span class="co">## 134 CatB</span>
<span class="co">## 135 CatB</span></code></pre></div>
<p>Note that p1 has a gtable plot object and data slot with qlist and grplab. The qlist accessed using <code>p1$data$qlist</code> and grplab data.frame accessed using <code>p1$data$grplab[[1]]</code> can used as input to <code><a href="../reference/plotQ.html">plotQ()</a></code> or <code><a href="../reference/plotQMultiline.html">plotQMultiline()</a></code>.</p>
<p><strong>Using RMarkdown</strong></p>
<p>As explained in the previous section, plots can be returned and saved. This can be handy when creating a report using RMarkdown. The returned plot(s) can be drawn using <code><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">gridExtra::grid.arrange()</a></code>.</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span>

<span class="co"># return plot and data (withgrplab)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,grplab<span class="op">=</span><span class="va">onelabset1</span>,
            grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-97-1.svg" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p>There are other functions that can readily plot a list of ggplot objects. For example, R package <code>cowplot</code> has a useful function <code>plot_grid()</code> for plotting a list of ggplot objects. And R package <code>ggpubr</code> has the function <code>ggarrange()</code>.</p>
<p><strong>Export dimensions and resolution</strong></p>
<p>The height, width, resolution and figure format can be changed as shown below. The <code>height</code> specifies the height of one panel if the plot is joined. The function multiplies the height values by the number of panels. Similarly, the <code>grplabheight</code> specifies the height of the group label panel with one group label set. Multiple label sets are multipled. The width of the plot is automatically calculated based on the number of individuals. This ranges from 5cm to 30cm.</p>
<div class="sourceCode" id="cb98"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">slist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">sfiles</span><span class="op">)</span>

<span class="co"># change height and width of figure</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, imgoutput<span class="op">=</span><span class="st">"sep"</span>, height<span class="op">=</span><span class="fl">1.5</span>, width<span class="op">=</span><span class="fl">8</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, imgoutput<span class="op">=</span><span class="st">"join"</span>, height<span class="op">=</span><span class="fl">1.5</span>, width<span class="op">=</span><span class="fl">8</span><span class="op">)</span>

<span class="co"># change resolution</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, dpi<span class="op">=</span><span class="fl">600</span><span class="op">)</span>
<span class="co"># change export figure format</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, imgtype<span class="op">=</span><span class="st">"tiff"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, imgtype<span class="op">=</span><span class="st">"pdf"</span><span class="op">)</span></code></pre></div>
<p><strong>Export filename</strong></p>
<p>The output file name is automatically generated. When <code>imgoutput="sep"</code>, the names of the ‘qlist’ are used to create output labels. When <code>imgoutput="join"</code>, one output label is created for all input files in this format: <code>JoinedNFiles-YYYYMMDDHHMMSS</code>, where N stands for number of runs joined, and the ending stands for current system date and time.</p>
<p>A custom output file name can be provided using <code>outputfilename</code>. When using <code>imgoutput="sep"</code>, <code>outputfilename</code> must be a character vector equal to length of input runs. When <code>imgoutput="join"</code>, <code>outputfilename</code> must be a character of length one. File extensions like .png etc must not be provided.</p>
<p><strong>Custom font</strong></p>
<p>Custom fonts can be used for the text in the plot using package <code>extrafont</code> or <code>showtext</code>. Refer to these packages for more information on loading fonts. Here is an example using <code>showtext</code>.</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#library(extrafont)</span>
<span class="co">#font_import(pattern="Gidole",prompt=F)</span>
<span class="co">#loadfonts()</span>
<span class="co">#fonts()</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yixuan/showtext">showtext</a></span><span class="op">)</span>
<span class="fu">font_add_google</span><span class="op">(</span><span class="st">"Patrick Hand"</span>,<span class="st">"patrick"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/showtext/man/showtext_auto.html">showtext_auto</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">slist1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span>,
           grplabsize<span class="op">=</span><span class="fl">3.5</span>,linesize<span class="op">=</span><span class="fl">0.8</span>,pointsize<span class="op">=</span><span class="fl">3</span>,
           grplab<span class="op">=</span><span class="va">onelabset1</span>,font<span class="op">=</span><span class="st">"patrick"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-99-1.svg" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 51: <em>Plot with custom font.</em></p>
<p><code><a href="../reference/plotQ.html">plotQ()</a></code> function has numerous arguments to tweak the plot as required. See <code><a href="../reference/plotQ.html">?plotQ</a></code> for more arguments and descriptions.</p>
<p><strong>Plotting CLUMPP output</strong></p>
<p>In similar manner, the <code>plotQ</code> function can be used to plot from COMBINED, ALIGNED or MERGED files.</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># select files from package</span>
<span class="va">co</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/STRUCTUREpop_K4-combined.txt"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>
<span class="va">al</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/STRUCTUREpop_K4-combined-aligned.txt"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>
<span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/STRUCTUREpop_K4-combined-merged.txt"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>

<span class="co"># all runs within the file are plotted</span>
<span class="co"># combined</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">co</span><span class="op">)</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span><span class="op">)</span>
<span class="co"># aligned</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">al</span><span class="op">)</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span><span class="op">)</span>
<span class="co"># merged only one run</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">me</span><span class="op">)</span>,returnplot<span class="op">=</span><span class="cn">T</span>,exportplot<span class="op">=</span><span class="cn">F</span>,basesize<span class="op">=</span><span class="fl">11</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p3</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,
             layout_matrix<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="cn">NA</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="cn">NA</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">3</span>,byrow<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-100-1.svg" width="960" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 52: <em>(A) Left: Combined file (Three STRUCTURE runs for K=4). (B) Middle: Aligned file (Three STRUCTURE runs for K=4 aligned using CLUMPP). (C) Right: Merged file (Three runs for K=4 merged into one table/figure using CLUMPP).</em></p>
</div>
</div>
<div id="plotqmultiline" class="section level2">
<h2 class="hasAnchor">
<a href="#plotqmultiline" class="anchor"></a>plotQMultiline</h2>
<p>The <code>plotQMultiline</code> function is also used to plot barplots from a ‘qlist’. The barplots can be plotted in multiple rows with individual labels to enable easier identification of individuals. The figure is produced as A4 size by default. The number of samples per line <code>spl</code> and the number of lines per page <code>lpp</code> is automatically calculated but it can also be specified manually. A schematic of the plot parts is shown below.</p>
<div class="figure">
<img src="figures/plotqmultiline-overview.png" alt=""><p class="caption">plotqmultiline-overview</p>
</div>
<p><b>Fig. </b> 53: <em>An overview of the components of a <code><a href="../reference/plotQMultiline.html">plotQMultiline()</a></code> figure and some of the arguments used to modify them.</em></p>
<p>It is recommended to read through the <code>plotQ</code> section first because many of the arguments are same and better explanied there.</p>
<p><code><a href="../reference/plotQMultiline.html">plotQMultiline()</a></code> plots one run per page. And multiple pages are exported for multiple runs. The output filename is the ‘qlist’ name followed by a number. Eg: filename-1.png. In case the number of individuals do not fit on a page, extra pages are exported per run. Then extra pages are named filename-2, filename-3 etc. But, the number of samples on a page can be manually controlled using <code>spl</code> and <code>lpp</code>.</p>
<div id="basic-usage" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-usage" class="anchor"></a>Basic usage</h3>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#do not use this command to read local files</span>
<span class="va">sfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/structure"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>, full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">slist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">sfiles</span>,indlabfromfile<span class="op">=</span><span class="cn">T</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#normal usage</span>
<span class="co">#plotQMultiline(slist[1], exportpath=getwd())</span>

<span class="co">#modified for this document</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-102-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 54: <em>Basic <code><a href="../reference/plotQMultiline.html">plotQMultiline()</a></code> plot. One run is spread across the whole page.</em></p>
<p>The number of individuals per line (samples per line <code>spl</code>) and the number of lines per page <code>lpp</code> can be controlled separately or together.</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#normal usage</span>
<span class="co">#plotQMultiline(slist[1],spl=60, exportpath=getwd())</span>

<span class="co">#modified for this document</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,spl<span class="op">=</span><span class="fl">60</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-103-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 55: <em>Basic <code><a href="../reference/plotQMultiline.html">plotQMultiline()</a></code> plot. One run is spread across the whole page.</em></p>
<p>When <code>spl</code> is fixed to 60, a new line created to accomodate the rest of the samples.</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#normal usage</span>
<span class="co">#plotQMultiline(slist[1],lpp=4, exportpath=getwd())</span>

<span class="co">#modified for this document</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,lpp<span class="op">=</span><span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-104-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 56: <em>Adjustment of lines per page.</em></p>
<p><code>lpp</code> can be increased to control aspect ratio of the plot. Decreasing <code>lpp</code> such that all samples cannot fit on one page or sometimes fixing <code>lpp</code> without adjusting <code>spl</code> forces creation of a new page.</p>
<p>More examples of adjustments.</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># basic usage</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co"># manually modifying samples per line and lines per page</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, lpp<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, spl<span class="op">=</span><span class="fl">75</span>, lpp<span class="op">=</span><span class="fl">9</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, spl<span class="op">=</span><span class="fl">149</span>, lpp<span class="op">=</span><span class="fl">9</span><span class="op">)</span>

<span class="co"># works with combined, aligned or merged files</span>
<span class="va">co</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/STRUCTUREpop_K4-combined.txt"</span>, package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">co</span><span class="op">)</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>,spl<span class="op">=</span><span class="fl">75</span>, lpp<span class="op">=</span><span class="fl">10</span><span class="op">)</span>

<span class="co"># change bar width and turn off labels</span>
<span class="va">al</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/STRUCTUREpop_K4-combined-aligned.txt"</span>, package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">al</span><span class="op">)</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, barsize<span class="op">=</span><span class="fl">1</span>, showindlab<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="co"># yaxis labels and ticks and modified height and width</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">al</span><span class="op">)</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, spl<span class="op">=</span><span class="fl">75</span>, lpp<span class="op">=</span><span class="fl">2</span>, showindlab<span class="op">=</span><span class="cn">T</span>, showyaxis<span class="op">=</span><span class="cn">T</span>, showticks<span class="op">=</span><span class="cn">T</span>, height<span class="op">=</span><span class="fl">5</span>, width<span class="op">=</span><span class="fl">20</span><span class="op">)</span>
<span class="co"># modified spl</span>
<span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/STRUCTUREpop_K4-combined-merged.txt"</span>, package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">me</span><span class="op">)</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, spl<span class="op">=</span><span class="fl">38</span>, height<span class="op">=</span><span class="fl">8</span>, width<span class="op">=</span><span class="fl">14</span><span class="op">)</span></code></pre></div>
</div>
<div id="individual-labels-1" class="section level3">
<h3 class="hasAnchor">
<a href="#individual-labels-1" class="anchor"></a>Individual labels</h3>
<p><code>plotMultiline()</code> labels individuals numerically with padded zeros (01,02,03..). The number of padded zeros depend on the total number of individuals. Less than 100 individuals start with 01, 02… while hundreds of individuals start with 001, 002.. etc. Labels with padded zeros are better suited for sorting. This is default behaviour <code>useindlab=F</code>. Instead of automatically creating the labels, predefined labels can be used from the rownames of input data by specifying <code>useindlab=T</code>. Custom labels can be manually added as rownames anytime.</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get a qlist</span>
<span class="va">list1</span> <span class="op">&lt;-</span> <span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="co"># show rownames</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">list1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>

<span class="co"># default labels</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">list1</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, useindlab<span class="op">=</span><span class="cn">F</span><span class="op">)</span>

<span class="co"># read some individual labels</span>
<span class="va">inds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/structureindlabels.txt"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>,
                   header<span class="op">=</span><span class="cn">FALSE</span>, stringsAsFactors<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># add labels as rownames to qlist</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">list1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">inds</span><span class="op">$</span><span class="va">V1</span>

<span class="co"># show custom labels</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">list1</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, useindlab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="co"># long ind name</span>
<span class="va">longlabs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"this_is_a_real_long_label_"</span>,<span class="va">inds</span><span class="op">$</span><span class="va">V1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">list1</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">longlabs</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">list1</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, useindlab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">list1</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, useindlab<span class="op">=</span><span class="cn">T</span>, spl<span class="op">=</span><span class="fl">75</span>, lpp<span class="op">=</span><span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">list1</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, useindlab<span class="op">=</span><span class="cn">T</span>, spl<span class="op">=</span><span class="fl">75</span>, lpp<span class="op">=</span><span class="fl">4</span><span class="op">)</span>

<span class="co"># if all runs are equal length, add indlab to all runs</span>
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="va">nrow</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="va">slist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="st">"rownames&lt;-"</span>,<span class="va">inds</span><span class="op">$</span><span class="va">V1</span><span class="op">)</span>
<span class="co"># show row names of all runs and all samples</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="va">rownames</span><span class="op">)</span></code></pre></div>
<p>Note that runs read in using <code><a href="../reference/readQ.html">readQ()</a></code> have rownames 1,2,3.. etc which may not be optimal for sorting by individual labels. For STRUCTURE files with individual labels in them, using <code><a href="../reference/readQ.html">readQ(indlabfromfile=T)</a></code> will read them in as rownames. See section <code><a href="../reference/readQ.html">readQ()</a></code>.</p>
<p>Individual labels are displayed on the plot by default when <code>showindlab=T</code>. They can be turned off by <code>showindlab=F</code>. Note that this only controls the display of individual labels on the plot. The labels are still present in the underlying data and are still in use for sorting etc.</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,barsize<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,barsize<span class="op">=</span><span class="fl">1</span>,useindlab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,nrow<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-107-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 57: <em>Top shows default ind labs and bottom shows ind labs from file.</em></p>
</div>
<div id="sort-individuals-1" class="section level3">
<h3 class="hasAnchor">
<a href="#sort-individuals-1" class="anchor"></a>Sort individuals</h3>
<p>Similar to <code><a href="../reference/plotQ.html">plotQ()</a></code>, the individuals can be sorted based on the value of any one of the clusters (‘Cluster1’), ‘all’ or ‘label’. The ‘all’ option produces a sort similar to that in the software STRUCTURE. All clusters are taken into account to sort individuals. When using the name of a cluster, like ‘Cluster1’, ‘Cluster2’ etc, all individuals are sorted by value of the specified cluster.</p>
<p>Using <code>sortind="label"</code> sorts individuals by individual labels. The default <code>useindlab=F</code>, creates labels numerically in the original order of data but with zero padding. For example, if there are 10 individuals, labels are 01, 02 up to 10. if there are 100 individuals, then labels are 001, 002 up to 100. Zero padding to ensure optimal sorting. When <code>useindlab=T</code>, labels are used from rownames of ‘qlist’ dataframes. They are usually labelled 1,2,3.. if read in using <code><a href="../reference/readQ.html">readQ()</a></code>. This can be an issue with sorting by labels <code>sortind="label"</code>. For STRUCTURE files with individual labels, they can be read in automatically using <code><a href="../reference/readQ.html">readQ(indlabfromfile=T)</a></code>. The rownames of ‘qlist’ dataframes can also be modified by the user.</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,lpp<span class="op">=</span><span class="fl">1</span>,barsize<span class="op">=</span><span class="fl">1</span>,useindlab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,lpp<span class="op">=</span><span class="fl">1</span>,barsize<span class="op">=</span><span class="fl">1</span>,useindlab<span class="op">=</span><span class="cn">T</span>,sortind<span class="op">=</span><span class="st">"Cluster1"</span><span class="op">)</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,lpp<span class="op">=</span><span class="fl">1</span>,barsize<span class="op">=</span><span class="fl">1</span>,useindlab<span class="op">=</span><span class="cn">T</span>,sortind<span class="op">=</span><span class="st">"all"</span><span class="op">)</span>
<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,lpp<span class="op">=</span><span class="fl">1</span>,barsize<span class="op">=</span><span class="fl">1</span>,useindlab<span class="op">=</span><span class="cn">T</span>,sortind<span class="op">=</span><span class="st">"label"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p2</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p3</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">p4</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,nrow<span class="op">=</span><span class="fl">4</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-108-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 58: <em>Various sorting options. Original order, ordered by Cluster1, ordered by all clusters and ordered by individual labels.</em></p>
</div>
<div id="group-labels-1" class="section level3">
<h3 class="hasAnchor">
<a href="#group-labels-1" class="anchor"></a>Group labels</h3>
<p>One or more sets of group labels can be added to the bottom of barplots by providing a ‘data.frame’ object. The number of rows of the ‘data.frame’ must be equal to the number of individuals. The header of the ‘data.frame’ is the group label set title. See section ‘Group labels’ under ‘plotQ’ for more information about group labels.</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#do not use this command to read local files</span>
<span class="va">threelabset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/metadata.txt"</span>, package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>, header<span class="op">=</span><span class="cn">T</span>,stringsAsFactors<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="va">twolabset</span> <span class="op">&lt;-</span> <span class="va">threelabset</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>
<span class="va">onelabset</span> <span class="op">&lt;-</span> <span class="va">threelabset</span><span class="op">[</span>,<span class="fl">2</span>,drop<span class="op">=</span><span class="cn">F</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,barsize<span class="op">=</span><span class="fl">1</span>,grplab<span class="op">=</span><span class="va">onelabset</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-110-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 59: <em>Using group labels with one label set.</em></p>
<p>Group labels are displayed on the top of the plot as strip panels by default. A gap is added between individuals of different label groups. By setting <code>indlabwithgrplab=T</code>, group labels can be concatenated to the individual labels using separator <code>indlabsep</code>. The default label separator is space. For example, individuals 1 and 2 with group labels popA and popB produces labels ‘1 popA’ and ‘2 popB’. Top strip panels can be turned off using <code>showgrplab=FALSE</code>.</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,barsize<span class="op">=</span><span class="fl">1</span>,grplab<span class="op">=</span><span class="va">onelabset</span>,indlabwithgrplab<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-111-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 60: <em>Using group labels with group labels concatenated to individual labels.</em></p>
<p>Multiple group label sets can be added. When using multiple group label sets, argument <code>selgrp</code> is used to declare which is the selected/active group. <code>selgrp</code> is used for <code>subsetgrp</code>, <code>grpmean</code> and <code>ordergrp</code>. <code>sortind</code> will sort within <code>selgrp</code>. If labels are in non-contiguous blocks, set <code>ordergrp=T</code> to order all labels into contiguous blocks starting with <code>selgrp</code>.</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,barsize<span class="op">=</span><span class="fl">1</span>,grplab<span class="op">=</span><span class="va">threelabset</span>,ordergrp<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-112-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 61: <em>Using group labels with three label set.</em></p>
</div>
<div id="subsetreorder-groups-1" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetreorder-groups-1" class="anchor"></a>Subset/reorder groups</h3>
<p>When using group labels, the plot can be subsetted or reordered based on group labels. When sorting individuals, all individuals are sorted by full individual names when using <code>sortind="labels"</code>. But when using <code>sortind="Cluster1"</code> or <code>sortind="all"</code>, individuals are sorted within groups.</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,barsize<span class="op">=</span><span class="fl">1</span>,grplab<span class="op">=</span><span class="va">threelabset</span>,ordergrp<span class="op">=</span><span class="cn">T</span>,subsetgrp<span class="op">=</span><span class="st">"Tropical"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-113-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 62: <em>Using group labels with subsetting.</em></p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,barsize<span class="op">=</span><span class="fl">1</span>,grplab<span class="op">=</span><span class="va">threelabset</span>,ordergrp<span class="op">=</span><span class="cn">T</span>,selgrp<span class="op">=</span><span class="st">"loc"</span>,subsetgrp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Greece"</span>,<span class="st">"Brazil"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-114-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 63: <em>Using group labels where selected group lab set ‘loc’ was reordered ‘Greece,Brazil’.</em></p>
<p>More examples of sorting, subsetting and reordering.</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># subsetting groups</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">list1</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">threelabset</span>, ordergrp<span class="op">=</span><span class="cn">T</span>, subsetgrp<span class="op">=</span><span class="st">"Tropical"</span><span class="op">)</span>
<span class="co"># change order of groups</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">list1</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">threelabset</span>, ordergrp<span class="op">=</span><span class="cn">T</span>, subsetgrp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Tropical"</span>,<span class="st">"Temperate"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># subsetting group and sorting individuals</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">list1</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">threelabset</span>, ordergrp<span class="op">=</span><span class="cn">T</span>, subsetgrp<span class="op">=</span><span class="st">"Tropical"</span>, sortind<span class="op">=</span><span class="st">"Cluster1"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">list1</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">threelabset</span>, ordergrp<span class="op">=</span><span class="cn">T</span>, subsetgrp<span class="op">=</span><span class="st">"Tropical"</span>, sortind<span class="op">=</span><span class="st">"all"</span><span class="op">)</span>

<span class="co"># change order of groups and sorting individuals</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">list1</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">threelabset</span>, ordergrp<span class="op">=</span><span class="cn">T</span>, subsetgrp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Tropical"</span>,<span class="st">"Temperate"</span><span class="op">)</span>, sortind<span class="op">=</span><span class="st">"Cluster1"</span><span class="op">)</span>

<span class="co"># use second group label set for subsetting and sorting</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">list1</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">threelabset</span>, selgrp<span class="op">=</span><span class="st">"cat"</span>, subsetgrp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CatA"</span>,<span class="st">"CatB"</span><span class="op">)</span>, sortind<span class="op">=</span><span class="st">"all"</span><span class="op">)</span></code></pre></div>
</div>
<div id="title-and-subtitle-1" class="section level3">
<h3 class="hasAnchor">
<a href="#title-and-subtitle-1" class="anchor"></a>Title and subtitle</h3>
<p>Title and/or subtitle can be displayed using <code>showtitle=T</code> and <code>showsubtitle=T</code> respectively. The file name is displayed by default. Custom label can be provided using <code>titlelab</code> or <code>subtitlelab</code>. If multiple plots are exported, then a character vector of labels equal to number of plots must be provided. Title/subtitle is only displayed in the topmost panel on the first page (in case of multiple pages).</p>
<div class="sourceCode" id="cb116"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,barsize<span class="op">=</span><span class="fl">1</span>,grplab<span class="op">=</span><span class="va">threelabset</span>,ordergrp<span class="op">=</span><span class="cn">T</span>,
                     showtitle<span class="op">=</span><span class="cn">T</span>,showsubtitle<span class="op">=</span><span class="cn">T</span>,titlelab<span class="op">=</span><span class="st">"Structure plot"</span>,
                     subtitlelab<span class="op">=</span><span class="st">"Population structure of my organism."</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-116-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 64: <em>Displaying titles and subtitles.</em></p>
</div>
<div id="legend-1" class="section level3">
<h3 class="hasAnchor">
<a href="#legend-1" class="anchor"></a>Legend</h3>
<p>Legend can be displayed using <code>showlegend=T</code>. The file name is displayed by default. The clusters in ‘qlist’ are by default named Cluster1, Cluster2 etc. The cluster names can be renamed by providing custom labels to argument <code>legendlab</code>. The length of <code>legendlab</code> must be equal to the max number of clusters in the selected runs. Legend is only displayed in the topmost panel on the first page (in case of multiple pages).</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#modified for this document</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span>,barsize<span class="op">=</span><span class="fl">1</span>,grplab<span class="op">=</span><span class="va">threelabset</span>,ordergrp<span class="op">=</span><span class="cn">T</span>,
                     showlegend<span class="op">=</span><span class="cn">T</span>,legendkeysize<span class="op">=</span><span class="fl">8</span>,legendtextsize<span class="op">=</span><span class="fl">10</span>,legendlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"group1"</span>,<span class="st">"group2"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span><span class="op">$</span><span class="va">plot</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-117-1.svg" width="768" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 65: <em>Displaying Legend.</em></p>
</div>
<div id="other-options-1" class="section level3">
<h3 class="hasAnchor">
<a href="#other-options-1" class="anchor"></a>Other options</h3>
<p>The cluster colours can be changed by passing a vector of colours to the argument <code>clustercol</code>. For examples of colour palettes, see section under <code><a href="../reference/plotQ.html">plotQ()</a></code>, ‘Cluster colours’.</p>
<div class="sourceCode" id="cb118"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># change cluster colours</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">list1</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, useindlab<span class="op">=</span><span class="cn">T</span>, clustercol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>,<span class="st">"coral"</span>,<span class="st">"darkorchid3"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># customise grplabels and indlabels</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">list1</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplab<span class="op">=</span><span class="va">onelabset</span>, grplabcol<span class="op">=</span><span class="st">"steelblue"</span>, grplabbgcol<span class="op">=</span><span class="st">"slategray1"</span>,
               indlabcol<span class="op">=</span><span class="st">"darkgreen"</span>, indlabangle<span class="op">=</span><span class="fl">45</span>, indlabvjust<span class="op">=</span><span class="fl">1</span>, indlabhjust<span class="op">=</span><span class="fl">1</span>,
               height<span class="op">=</span><span class="fl">12</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>

<span class="co"># create plot similar to plotQ</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">list1</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, useindlab<span class="op">=</span><span class="cn">T</span>, barsize<span class="op">=</span><span class="fl">1</span>, spl<span class="op">=</span><span class="fl">149</span>, lpp<span class="op">=</span><span class="fl">1</span>, height<span class="op">=</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="figures/plotqmultiline-colours.png" alt=""><p class="caption">plotqmultiline-colours</p>
</div>
<p><b>Fig. </b> 66: <em>Multiline plots with (left) standard colours, (middle) <code>rich.colors()</code> from <code>gplots</code> package and (right) <code>brewer.pal(8,'Spectral')</code> from <code>RColorBrewer</code> package.</em></p>
<p>Output file names are created automatically by default using the input ‘qlist’ names. When number of individuals exceed one page and extra pages are created, incremental numbers are added to the run name like so: -1, -2 etc. Custom file name can be provided to <code>outputfilename</code>. The number of labels must be equal to the number of input runs. Incremental numbers are still added if extra pages are created.</p>
<p>The plot can be returned and saved as done in this document.</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#modified for this document</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportplot<span class="op">=</span><span class="cn">F</span>,returnplot<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>
<span class="co">## $plot</span>
<span class="co">## $plot[[1]]</span>
<span class="co">## $plot[[1]]$structure_01</span>
<span class="co">## TableGrob (2 x 1) "arrange": 2 grobs</span>
<span class="co">##   z     cells    name           grob</span>
<span class="co">## 1 1 (1-1,1-1) arrange gtable[layout]</span>
<span class="co">## 2 2 (2-2,1-1) arrange gtable[layout]</span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## </span>
<span class="co">## $data</span>
<span class="co">## $data$qlist</span>
<span class="co">## [1] NA</span>
<span class="co">## </span>
<span class="co">## $data$grplab</span>
<span class="co">## [1] NA</span></code></pre></div>
<p>The returned object is a list with slots: plot and data. The plot slot contains a gtable plot object (result from <code><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">gridExtra::arrangeGrob()</a></code>) and the data slot contains two slots: qlist and grplab. The qlist contains the processed qlist and the grplab contains processed group labels. In the above example, only the plot slot is filled because only <code>returnplot=T</code> was used. The data is also returned if <code>returndata=T</code> is used. When exporting the image, a location other than the current working directory can be specified using <code>exportpath</code>.</p>
<p>Note that this function can be slow and takes several minutes to run depending on number of individuals and number of files selected.</p>
</div>
</div>
</div>
<div id="analyseq" class="section level1">
<h1 class="hasAnchor">
<a href="#analyseq" class="anchor"></a>analyseQ</h1>
<p>This is a wrapper function for easily performing several <code>pophelper</code> functions in one function. Input files can be STRUCTURE, TESS or BASIC run files. The <code><a href="../reference/analyseQ.html">analyseQ()</a></code> function performs a tabulation of runs, summarising of runs, perform Evanno method (for STRUCTURE runs only) and generates barplots.</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># basic usage</span>
<span class="co"># analyseQ(choose.files(), exportpath=getwd())</span>

<span class="va">sfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/structure"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>,full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="../reference/analyseQ.html">analyseQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">sfiles</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">tfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/tess"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>,full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="../reference/analyseQ.html">analyseQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">tlist</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">sfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/structure"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>,full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="../reference/analyseQ.html">analyseQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">alist</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<hr>
</div>
<div id="working-code" class="section level1">
<h1 class="hasAnchor">
<a href="#working-code" class="anchor"></a>Working code</h1>
<p>Here is a list of all functions in a order typical of workflow. The steps are applicable to all run types unless indicated.</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># collect runs (only for TESS 2.3 output)</span>
<span class="fu"><a href="../reference/collectRunsTess.html">collectRunsTess</a></span><span class="op">(</span>runsdir<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/choose.dir.html">choose.dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co"># choose runs</span>
<span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/choose.files.html">choose.files</a></span><span class="op">(</span>multi<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">qlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">files</span><span class="op">)</span>

<span class="co"># convert TESS 3 object to qlist (only for TESS 3)</span>
<span class="va">tlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQTess3.html">readQTess3</a></span><span class="op">(</span><span class="va">tess3object</span><span class="op">)</span>

<span class="co"># tabulate runs</span>
<span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tabulateQ.html">tabulateQ</a></span><span class="op">(</span><span class="va">qlist</span><span class="op">)</span>
<span class="co"># summarise runs</span>
<span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/summariseQ.html">summariseQ</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span>

<span class="co"># Evanno method (only for STRUCTURE runs)</span>
<span class="fu"><a href="../reference/evannoMethodStructure.html">evannoMethodStructure</a></span><span class="op">(</span><span class="va">df2</span>, exportplot<span class="op">=</span><span class="cn">T</span>,exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co"># plot runs</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">qlist</span>,exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">qlist</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># plot multiline</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">qlist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQMultiline.html">plotQMultiline</a></span><span class="op">(</span><span class="va">qlist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, spl<span class="op">=</span><span class="fl">70</span>, lpp<span class="op">=</span><span class="fl">10</span><span class="op">)</span>

<span class="co"># align clusters</span>
<span class="va">qlist1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/alignK.html">alignK</a></span><span class="op">(</span><span class="va">qlist</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">qlist1</span>,exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>

<span class="co"># or all together</span>
<span class="fu"><a href="../reference/analyseQ.html">analyseQ</a></span><span class="op">(</span><span class="va">qfiles</span>,exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<hr>
</div>
<div id="working-with-qlists" class="section level1">
<h1 class="hasAnchor">
<a href="#working-with-qlists" class="anchor"></a>Working with qlists</h1>
<p>The <code><a href="../reference/readQ.html">readQ()</a></code> function in <code>pophelper</code> is used to read in these different input file types and convert them into an R list object. This list is referred to as a ‘qlist’. For those familiar with R, a ‘qlist’ is just a regular list datatype in R. Each table/file is converted to a ‘data.frame’ object which is stored in a list. Multiple runs would be a list of lists.</p>
<p>A schematic data structure of a two run ‘qlist’ would look like below:</p>
<p>An example is shown below</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/structure"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>,full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span>files<span class="op">=</span><span class="va">sfiles</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">sf</span><span class="op">)</span></code></pre></div>
<p>The function <code><a href="../reference/is.qlist.html">is.qlist()</a></code> can be used to verify if a ‘qlist’ meets the basic structure to work with <code>pophelper</code> functions. <code><a href="../reference/is.qlist.html">is.qlist()</a></code> returns <code>TRUE</code> if yes else <code>FALSE</code> with warnings.</p>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/is.qlist.html">is.qlist</a></span><span class="op">(</span><span class="va">sf</span><span class="op">)</span></code></pre></div>
<p>A ‘qlist’ can also be create manually or generated in R just like any other list without using the <code><a href="../reference/readQ.html">readQ()</a></code> function in <code>pophelper</code>. But, note that <code><a href="../reference/evannoMethodStructure.html">evannoMethodStructure()</a></code> needs the attributes associated with the ‘data.frame’. Other functions currently do not use the attributes.</p>
<p>Here is a toy ‘qlist’ object</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create two data frames</span>
<span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>A<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="fl">0.2</span><span class="op">)</span>, B<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.6</span>,<span class="fl">0.4</span>,<span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>
<span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>A<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span><span class="op">)</span>, B<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.7</span>,<span class="fl">0.9</span>,<span class="fl">0.5</span>,<span class="fl">0.4</span><span class="op">)</span><span class="op">)</span>

<span class="co"># one-element qlist</span>
<span class="va">q1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">df1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">q1</span><span class="op">)</span>
<span class="va">q2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"sample1"</span><span class="op">=</span><span class="va">df1</span>, <span class="st">"sample2"</span><span class="op">=</span><span class="va">df2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">q2</span><span class="op">)</span>
<span class="co">## List of 1</span>
<span class="co">##  $ :'data.frame':    4 obs. of  2 variables:</span>
<span class="co">##   ..$ A: num [1:4] 0.2 0.4 0.6 0.2</span>
<span class="co">##   ..$ B: num [1:4] 0.8 0.6 0.4 0.8</span>
<span class="co">## List of 2</span>
<span class="co">##  $ sample1:'data.frame': 4 obs. of  2 variables:</span>
<span class="co">##   ..$ A: num [1:4] 0.2 0.4 0.6 0.2</span>
<span class="co">##   ..$ B: num [1:4] 0.8 0.6 0.4 0.8</span>
<span class="co">##  $ sample2:'data.frame': 4 obs. of  2 variables:</span>
<span class="co">##   ..$ A: num [1:4] 0.3 0.1 0.5 0.6</span>
<span class="co">##   ..$ B: num [1:4] 0.7 0.9 0.5 0.4</span></code></pre></div>
<div id="is-qlist" class="section level2">
<h2 class="hasAnchor">
<a href="#is-qlist" class="anchor"></a>is.qlist</h2>
<p>The function <code><a href="../reference/is.qlist.html">is.qlist()</a></code> can be used to check if this is a valid qlist object.</p>
<pre><code>Error in is.qlist(q1) :
  is.qlist: List elements are not named. Add names or run as.qlist().</code></pre>
<p>There is an error about list elements not being named.</p>
<p>There are warnings about column name formatting and missing attributes. All of these issues can be fixed using <code><a href="../reference/as.qlist.html">as.qlist()</a></code>.</p>
</div>
<div id="as-qlist" class="section level2">
<h2 class="hasAnchor">
<a href="#as-qlist" class="anchor"></a>as.qlist</h2>
<p>The function <code><a href="../reference/as.qlist.html">as.qlist()</a></code> is used to fix formatting issues with qlist or qlist-like objects. This function can be used to fix missing names of list elements, non-standard column names and missing attributes ‘ind’ and ‘k’.</p>
</div>
<div id="joinq" class="section level2">
<h2 class="hasAnchor">
<a href="#joinq" class="anchor"></a>joinQ</h2>
<p>qlists can be joined together to create one qlist using <code><a href="../reference/joinQ.html">joinQ()</a></code>.</p>
<pre><code>## [1] 2
## [1] 2
## [1] 4</code></pre>
</div>
<div id="sortq" class="section level2">
<h2 class="hasAnchor">
<a href="#sortq" class="anchor"></a>sortQ</h2>
<p>The function <code><a href="../reference/sortQ.html">sortQ()</a></code> is used to order the runs in a qlist based on an attribute. For example, ordering the run by <em>K</em> or by number of individuals.</p>
<p><img src="index_files/figure-html/unnamed-chunk-132-1.svg" width="700" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 67: <em>Plot showing action of sortQ(). Left shows order of runs before sorting and right shows order of runs after sorting.</em></p>
<p><code><a href="../reference/sortQ.html">sortQ()</a></code> by default sorts by <em>K</em>. This can be changed using the <code>by</code> argument. Runs can be sorted by number of individuals for example by setting <code><a href="../reference/sortQ.html">sortQ(q1,by="ind")</a></code>. More than one variable can be used for sorting for example; <code><a href="../reference/sortQ.html">sortQ(q1,by=c("ind","k"))</a></code>. The variable provided in <code>by</code> must be one of attributes in the data. This can be checked using</p>
<pre><code>##           sample2      sample3      sample1      sample4     
## names     Character,2  Character,2  Character,3  Character,3 
## class     "data.frame" "data.frame" "data.frame" "data.frame"
## row.names Integer,4    Integer,4    Integer,4    Integer,4   
## ind       4            4            4            4           
## k         2            2            3            3</code></pre>
<p>where the rownames on the left denote attributes. Any attribute except <strong>names</strong>, <strong>class</strong> or <strong>row.names</strong> can be used as variables to sort.</p>
</div>
<div id="mergeq" class="section level2">
<h2 class="hasAnchor">
<a href="#mergeq" class="anchor"></a>mergeQ</h2>
<p>Runs of the same K can be merged together using the mean values.</p>
<div class="alert alert-warning" role="alert">
<p>It makes more sense if the clusters are aligned before merging.</p>
</div>
<p><img src="index_files/figure-html/unnamed-chunk-135-1.svg" width="576" style="display: block; margin: auto auto auto 0;"></p>
<p><b>Fig. </b> 68: <em>Plot showing the action of function <code><a href="../reference/mergeQ.html">mergeQ()</a></code>. Top plot shows six runs (3xK=2 &amp; 3xK=3). Second plot shows the same runs after cluster alignment. And in the last panel, the replicates runs are merged by averaging the assignment proportions.</em></p>
</div>
<div id="splitq" class="section level2">
<h2 class="hasAnchor">
<a href="#splitq" class="anchor"></a>splitQ</h2>
<p>A qlist can be split into sublists based on an attribute.</p>
<pre><code>##   loci ind k runs  elpdmean     elpdsd   elpdmin   elpdmax
## 1   25 149 2    3 -7509.367  0.8082904 -7510.175 -7508.558
## 2   25 149 3    3 -7476.000  0.4358899 -7476.436 -7475.564
## 3   25 149 4    3 -7650.800 46.1418465 -7696.942 -7604.658
## 4   25 149 5    3 -7743.567 74.0671542 -7817.634 -7669.500
## 5   25 149 6    3 -7985.833 32.6353081 -8018.469 -7953.198
## 6   25 149 7    2 -8614.000 60.5283405 -8674.528 -8553.472</code></pre>
<p>We can see that there are 6 <em>K</em> groups. We can now split the qlist by <em>K</em>.</p>
<pre><code>## List of 6
##  $ 2:List of 3
##  $ 3:List of 3
##  $ 4:List of 3
##  $ 5:List of 3
##  $ 6:List of 3
##  $ 7:List of 2</code></pre>
<p>This creates a list of qlists. In this example, there are 6 list items each containing around 3 runs. Similarily the qlist can be split by other attributes, for example <code><a href="../reference/splitQ.html">splitQ(slist,by="ind")</a></code>. The variable provided in <code>by</code> must be one of attributes in the data. This can be checked using <code><a href="https://rdrr.io/r/base/lapply.html">sapply(slist,attributes)</a></code> where the rownames on the left denote attributes. Any attribute except <strong>names</strong>, <strong>class</strong> or <strong>row.names</strong> can be used as variables to split.</p>
</div>
<div id="other" class="section level2">
<h2 class="hasAnchor">
<a href="#other" class="anchor"></a>Other</h2>
<p>Below are some useful R routines that can be used to subset and filter a ‘qlist’. Since ‘qlist’ is a regular R list, all the below scripts are regular R scripts and nothing specific to this package or this object.</p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Read some STRUCTURE files (do not use this command to read local files)</span>
<span class="va">sfiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/structure"</span>,package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>, full.names<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">slist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">sfiles</span><span class="op">)</span>

<span class="co">#Subsetting and filtering on an qlist (R list of dataframes).</span>

<span class="co"># get number of runs</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">slist</span><span class="op">)</span>
<span class="co"># get names of runs</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">slist</span><span class="op">)</span>
<span class="co"># get number of clusters in each run</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="va">ncol</span><span class="op">)</span>
<span class="co"># get number of individuals in each run</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="va">nrow</span><span class="op">)</span>

<span class="co"># Filtering runs</span>
<span class="co"># get runs by position</span>
<span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>
<span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span>
<span class="co"># get a specific run by name</span>
<span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"structure_15"</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">slist</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="co"># get a run based on run name starting with a certain string</span>
<span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"^structure"</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">slist</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="co"># get a run based on run name ending with a certain string</span>
<span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"12$"</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">slist</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="co"># get runs with more than 2 clusters</span>
<span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span>
<span class="co"># get runs where any individual has probabilities greater than 0.5 in the first cluster</span>
<span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>

<span class="co"># Filtering clusters</span>
<span class="co"># get the first cluster from all runs</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="st">"["</span>,<span class="fl">1</span><span class="op">)</span>
<span class="co"># get clusters by position from all runs.</span>
<span class="co"># Can't use 1:3 because first run contain only 2 clusters.</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="st">"["</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>

<span class="co"># Filtering individuals</span>
<span class="co"># get individuals by row position from all runs</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">30</span>,<span class="op">]</span><span class="op">)</span>
<span class="co"># get an individual by name from all runs</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="st">"I13379"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>
<span class="co"># get multiple individuals by name from all runs</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"I13379"</span>,<span class="st">"I12616"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>
<span class="co"># or</span>
<span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"I13379"</span>,<span class="st">"I12616"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html">match</a></span><span class="op">(</span><span class="va">labs</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>
<span class="co"># get individuals that start with a certain string from all runs</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"^I133"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>
<span class="co"># get individuals that end with a certain string from all runs</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"3$"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>
<span class="co"># get individuals that contain a certain string from all runs</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">"388"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span><span class="op">)</span>
<span class="co"># get individuals with probabilities greater than 0.2</span>
<span class="co"># in the first cluster from all runs</span>
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">slist</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&gt;</span><span class="fl">0.2</span>,<span class="op">]</span><span class="op">)</span></code></pre></div>
<hr>
</div>
</div>
<div id="legacy" class="section level1">
<h1 class="hasAnchor">
<a href="#legacy" class="anchor"></a>Legacy</h1>
<p>Old functions that do not need to be used. But is included here optionally.</p>
<div id="clumpp" class="section level2">
<h2 class="hasAnchor">
<a href="#clumpp" class="anchor"></a>CLUMPP</h2>
<p>The software CLUMPP is commonly used to fix label switching between clusters. If you prefer to use CLUMPP, there is a helper function to generate the files required to run CLUMPP.</p>
<p>The function <code><a href="../reference/clumppExport.html">clumppExport()</a></code> takes a ‘qlist’, combines runs by <em>K</em> and generates a combined data file and a paramfile in separate directories. The combined file contains the tabular cluster data from all the repeats and runs. The paramfile contains information for the CLUMPP executable. The name for the folder can be changed optionally using the argument <code>prefix="something"</code>.</p>
<div class="figure">
<img src="figures/clumpp-folder.png" alt=""><p class="caption">clumpp-folder-preview</p>
</div>
<p><b>Fig. </b> 69: <em>Directories created from clumpp export (left) and the contents of each folder (right).</em></p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="va">clumppExport</span>
<span class="co"># clumppExport(qlist=NULL, prefix=NA, parammode=NA, paramrep=NA, exportpath=getwd())</span>
<span class="co"># export folders are prefixed as pop by default, to change, use prefix="foo"</span>
<span class="co"># To change clumpp algorithm, set parammode=1, parammode=2 or parammode=3.</span>
<span class="co"># If clumpp is slow, increase parammode</span>
<span class="co"># To change number of clumpp repeats, set paramrep=200, paramrep=500 etc.</span>

<span class="co"># optionally change folder name</span>
<span class="fu"><a href="../reference/clumppExport.html">clumppExport</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist</span>, prefix<span class="op">=</span><span class="st">"Set1"</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="alert alert-warning" role="alert">
<p>This function does not execute CLUMPP. CLUMPP must be downloaded and run manually. This function only generates the input files required to run CLUMPP.</p>
</div>
<p>The CLUMPP executable can be copied and pasted into each of these directories and executed by running it. The CLUMPP executable uses the combined file and the param file to generate three output files: aligned file, merged file and misc file.</p>
<div class="figure">
<img src="figures/clumpp-output.png" alt=""><p class="caption">clumpp-folder-results</p>
</div>
<p><b>Fig. </b> 70: <em>Directory showing CLUMPP results: aligned file, merged file and misc file.</em></p>
<p>The aligned file contains all the runs as in the combined file after realignment of clusters. In contrast, the merged file contains only one table which merges all the aligned runs to create a consensus run. The merged file makes sense only if all the aligned runs have similar assignments. The merged file is not recommended for downstream use unless you know what you are doing. The miscfile contains run parameters and other details.</p>
<p>We run our example samples.</p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># generate clumpp files, run clumpp and produce aligned files</span>
<span class="fu"><a href="../reference/clumppExport.html">clumppExport</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">10</span><span class="op">)</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>Folder created: pop_K3
pop_K3-combined.txt exported.
paramfile exported.</code></pre>
<p>And then manually run the CLUMPP executable.</p>
<pre><code>
-----------------------------------------------------------------
-----------------------------------------------------------------
CLUMPP by M. Jakobsson and N. A. Rosenberg (2007)
              Code by M. Jakobsson
           Version 1.1.2 (May 2009)
-----------------------------------------------------------------
-----------------------------------------------------------------


Parameter settings
----------------------- Main parameters -------------------------
DATATYPE = 1
INDFILE =
POPFILE = pop_K3-combined.txt
OUTFILE = pop_K3-combined-merged.txt
MISCFILE = pop_K3-combined-miscfile.txt
K = 3
C = 149
R = 3
M = 2
W = 0
S = 2
- Additional options for the Greedy and LargeKGreedy algorithms -
GREEDY_OPTION = 2
REPEATS = 20
PERMUTATIONFILE =
----------------------- Optional outputs ------------------------
PRINT_PERMUTED_DATA = 1
PERMUTED_DATAFILE = pop_K3-combined-aligned.txt
PRINT_EVERY_PERM = 0
EVERY_PERMFILE =
PRINT_RANDOM_INPUTORDERFILE = 0
RANDOM_INPUTORDERFILE =
----------------------- Advanced options ------------------------
OVERRIDE_WARNINGS = 0
ORDER_BY_RUN = 0


In total, 20 configurations of runs and clusters will be tested.

Running...
----------------------------------
Best estimate of H'  Repeat number (of 20)
0.995447938961547    1


Results
----------------------------------
The highest value of H' is: 0.995447938961547

The list of permutation of the clusters that produces that
H' value is (each run is on a separate row)
3 2 1
1 2 3
3 2 1

The program finished in (days:hours:minutes:seconds)
0:0:0:0

Press Return to exit...
-----------------------
Run completed.</code></pre>
<p>The aligned file can be read in and plotted.</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># read aligned file</span>
<span class="va">aligned</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="st">"./pop_K3/pop_K3-combined-aligned.txt"</span><span class="op">)</span>

<span class="co">#plot</span>
<span class="fu"><a href="../reference/plotQ.html">plotQ</a></span><span class="op">(</span><span class="va">aligned</span>,imgoutput<span class="op">=</span><span class="st">"join"</span>,exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>To read more about CLUMPP<sup>4</sup>, see references. Note that CLUMPP can only be used to align clusters with a given <em>K</em>. Clusters cannot be aligned across multiple <em>K</em>. For details on aligning clusters across multiple <em>K</em>, see <a href="http://clumpak.tau.ac.il/">CLUMPAK</a><sup>10</sup>.</p>
<p>The CLUMPP output files are now distributed in multiple folders. The aligned, merged or both files can be copied from multiple folders into a single folder for further analyses using the function <code><a href="../reference/collectClumppOutput.html">collectClumppOutput()</a></code>. The working directory is set suitably before running this function. This function need a <code>prefix</code> argument which denotes the prefix used in the previous function or the text before the underscore. For ex. a directory named <code>pop_K2</code> has the prefix <code>pop</code>.</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># set working directory</span>
<span class="fu"><a href="https://rdrr.io/r/base/getwd.html">setwd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/choose.dir.html">choose.dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># collect aligned files. Default prefix is pop</span>
<span class="fu"><a href="../reference/collectClumppOutput.html">collectClumppOutput</a></span><span class="op">(</span>runsdir<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>,newdir<span class="op">=</span><span class="st">"aligned"</span><span class="op">)</span>

<span class="co"># working directory can also be set using runsdir argument</span>
<span class="fu"><a href="../reference/collectClumppOutput.html">collectClumppOutput</a></span><span class="op">(</span>runsdir<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/utils/choose.dir.html">choose.dir</a></span><span class="op">(</span><span class="op">)</span>,newdir<span class="op">=</span><span class="st">"aligned"</span><span class="op">)</span>

<span class="co"># collect both aligned and merged files</span>
<span class="fu"><a href="../reference/collectClumppOutput.html">collectClumppOutput</a></span><span class="op">(</span>runsdir<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>,newdir<span class="op">=</span><span class="st">"both"</span>,filetype<span class="op">=</span><span class="st">"both"</span><span class="op">)</span>

<span class="op">?</span><span class="va">collectClumppOutput</span>
<span class="co"># collectClumppOutput(prefix="pop", filetype="aligned", runsdir=NA, newdir=NA)</span>

<span class="co"># to change which files are copied, set filetype="aligned", filetype="both" or</span>
<span class="co"># filetype="merged"</span>
<span class="co"># to change name of new directory, set newdir="somename"</span>

<span class="op">?</span><span class="fu"><a href="../reference/collectClumppOutput.html">collectClumppOutput</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Collecting the aligned and merged files into a single folder can be helpful in plotting these files. From the command above, both aligned and merged files are copied into the new directory.</p>
</div>
<div id="distructexport" class="section level2">
<h2 class="hasAnchor">
<a href="#distructexport" class="anchor"></a>distructExport</h2>
<p>DISTRUCT<sup>7</sup> is one of the original programs written to generate assignment barplots from a q-matrix. This function generates all output files necessary to run DISTRUCT from a ‘qlist’. A directory labelled ‘filename-distruct’ is created for each input file. Each directory contains the ‘filename-indq.txt’, ‘filename-grpq.txt’, ‘filename-colours.txt’ and ‘drawparams’. If grplab is in use, then ‘filename-grplabbottom.txt’ and/or ‘filename-grplabtop.txt’ are also created. The DISTRUCT executable can be run in this directory to create a ‘filename.ps’ postcript vector file. The ‘filename.ps’ file can be imported into a vector image editing software or seen using a viewer.</p>
<div class="alert alert-warning" role="alert">
<p>This function does not execute DISTRUCT. DISTRUCT must be downloaded and run manually. This function only generates the input files required to run DISTRUCT.</p>
</div>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.delim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"files/metadata.txt"</span>, package<span class="op">=</span><span class="st">"pophelper"</span><span class="op">)</span>, header<span class="op">=</span><span class="cn">T</span>,stringsAsFactors<span class="op">=</span><span class="cn">F</span><span class="op">)</span>

<span class="co"># basic usage</span>
<span class="fu"><a href="../reference/distructExport.html">distructExport</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># with bottom labels</span>
<span class="fu"><a href="../reference/distructExport.html">distructExport</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplabbottom<span class="op">=</span><span class="va">labs</span><span class="op">$</span><span class="va">type</span><span class="op">)</span>
<span class="co"># with top labels</span>
<span class="fu"><a href="../reference/distructExport.html">distructExport</a></span><span class="op">(</span>qlist<span class="op">=</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grplabtop<span class="op">=</span><span class="va">labs</span><span class="op">$</span><span class="va">cat</span><span class="op">)</span>
<span class="co"># with group mean</span>
<span class="fu"><a href="../reference/distructExport.html">distructExport</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grpmean<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="co"># grayscale colours</span>
<span class="fu"><a href="../reference/distructExport.html">distructExport</a></span><span class="op">(</span><span class="va">slist</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, grayscale<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="co"># TESS files</span>
<span class="fu"><a href="../reference/distructExport.html">distructExport</a></span><span class="op">(</span><span class="va">tlist</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># ADMIXTURE files, adjust if plot does not fit on canvas</span>
<span class="fu"><a href="../reference/distructExport.html">distructExport</a></span><span class="op">(</span><span class="va">alist</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span>, indwidth<span class="op">=</span><span class="fl">0.36</span>, xorigin<span class="op">=</span><span class="fl">15</span><span class="op">)</span>
<span class="co"># CLUMPP files</span>
<span class="fu"><a href="../reference/distructExport.html">distructExport</a></span><span class="op">(</span><span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">co</span><span class="op">)</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/distructExport.html">distructExport</a></span><span class="op">(</span><span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">al</span><span class="op">)</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/distructExport.html">distructExport</a></span><span class="op">(</span><span class="fu"><a href="../reference/readQ.html">readQ</a></span><span class="op">(</span><span class="va">me</span><span class="op">)</span>, exportpath<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="figures/destruct-structure.png" alt=""><p class="caption">distructexport</p>
</div>
<p><b>Fig. </b> 71: <em>Left: DISTRUCT plot with <code>grpmean=F</code>. Middle: DISTRUCT plot with <code>grpmean=T</code>. Right: DISTRUCT plot with <code>grayscale=T</code></em></p>
</div>
</div>
<div id="interactive-app" class="section level1">
<h1 class="hasAnchor">
<a href="#interactive-app" class="anchor"></a>Interactive app</h1>
<p>Many of the functionalities in this package have been implemented as an interactive graphical tool using the shiny web framework. For those who prefer a graphical web interface, this may be useful. Further information is available at <a href="http://royfrancis.github.io/pophelperShiny/">pophelperShiny</a>.</p>
<hr>
</div>
<div id="citation" class="section level1">
<h1 class="hasAnchor">
<a href="#citation" class="anchor"></a>Citation</h1>
<blockquote>
<p>Francis, R. M. (2017). POPHELPER: an R package and web app to analyse and visualize population structure. <em>Molecular Ecology Resources, 17</em>(1), 27-32. DOI: 10.1111/1755-0998.12509</p>
</blockquote>
<hr>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<ol style="list-style-type: decimal">
<li><p><a href="http://genome.cshlp.org/content/19/9/1655.long">Alexander D.H., Novembre, J. and Lange K. (2009). Fast model-based estimation of ancestry in unrelated individuals. Genome Research, 19:1655-1664</a></p></li>
<li><p><a href="http://onlinelibrary.wiley.com/doi/10.1111/j.1365-294X.2005.02553.x/abstract">Evanno G., Regnaut S., and Goudet J. (2005). Detecting the number of clusters of individuals using the software STRUCTURE: a simulation study. Molecular ecology, 14(8), 2611-2620</a></p></li>
<li><p><a href="http://onlinelibrary.wiley.com/doi/10.1111/j.1755-0998.2010.02868.x/abstract">Francois O., and Durand E. (2010). Spatially explicit Bayesian clustering models in population genetics. Molecular Ecology Resources, 10(5), 773-784</a></p></li>
<li><p><a href="http://bioinformatics.oxfordjournals.org/content/23/14/1801.short">Jakobsson M., and Rosenberg N. A. (2007). CLUMPP: a cluster matching and permutation program for dealing with label switching and multimodality in analysis of population structure. Bioinformatics, 23(14), 1801-1806</a></p></li>
<li><p><a href="http://www.genetics.org/content/155/2/945.short">Pritchard J. K., Stephens M., &amp; Donnelly P. (2000). Inference of population structure using multilocus genotype data. Genetics, 155(2), 945-959</a></p></li>
<li><p><a href="http://www.genetics.org/content/early/2014/04/14/genetics.114.164350">Raj A., Stephens M., Pritchard J.K. (2014). fastSTRUCTURE: variational inference of population structure in large SNP data sets. Genetics 197, 573-589</a></p></li>
<li><p><a href="http://onlinelibrary.wiley.com/doi/10.1046/j.1471-8286.2003.00566.x/abstract">Rosenberg, Noah A. “DISTRUCT: a program for the graphical display of population structure.” Molecular Ecology Notes 4.1 (2004): 137-138.</a></p></li>
<li><p><a href="https://academic.oup.com/bioinformatics/article/20/15/2363/233009/BAPS-2-enhanced-possibilities-for-the-analysis-of">Corander, J., Waldmann, P., Marttinen, P., &amp; Sillanpaa, M. J. (2004). BAPS 2: enhanced possibilities for the analysis of genetic population structure. Bioinformatics, 20(15), 2363-2369.</a></p></li>
<li><p><a href="https://www.jstatsoft.org/article/view/v069c01">Panagiotis Papastamoulis (2016). label.switching: An R Package for Dealing with the Label Switching Problem in MCMC Outputs. Journal of Statistical Software, 69(1), 1-24.</a></p></li>
<li><p><a href="https://onlinelibrary.wiley.com/doi/full/10.1111/1755-0998.12387">Kopelman, N. M., Mayzel, J., Jakobsson, M., Rosenberg, N. A., &amp; Mayrose, I. (2015). Clumpak: a program for identifying clustering modes and packaging population structure inferences across K. Molecular ecology resources, 15(5), 1179-1191.</a></p></li>
</ol>
<hr>
</div>
<div id="useful-links" class="section level1">
<h1 class="hasAnchor">
<a href="#useful-links" class="anchor"></a>Useful Links</h1>
<ul>
<li><a href="http://web.stanford.edu/group/pritchardlab/structure.html">STRUCTURE program</a></li>
<li><a href="http://membres-timc.imag.fr/Olivier.Francois/tess.html">TESS program</a></li>
<li><a href="http://www.helsinki.fi/bsg/software/BAPS/">BAPS program</a></li>
<li><a href="https://www.genetics.ucla.edu/software/admixture/">ADMIXTURE program</a></li>
<li><a href="https://rajanil.github.io/fastStructure/">fastSTRUCTURE program</a></li>
<li><a href="http://www.stanford.edu/group/rosenberglab/clumpp.html">CLUMPP program for label switching within K</a></li>
<li><a href="http://taylor0.biology.ucla.edu/structureHarvester">Structure Harvester</a></li>
<li><a href="https://web.stanford.edu/group/rosenberglab/distruct.html">Distruct program for barplots</a></li>
<li><a href="http://clumpak.tau.ac.il/">CLUMPAK program for label switching across K</a></li>
<li><a href="https://github.com/sa-lee/starmie">Starmie R package for plotting and inference</a></li>
<li><a href="https://github.com/eriqande/Rrunstruct">Runstruct R package for inference</a></li>
</ul>
<hr>
</div>
<div id="environment" class="section level1">
<h1 class="hasAnchor">
<a href="#environment" class="anchor"></a>Environment</h1>
<pre><code>## R version 4.0.0 (2020-04-24)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.1 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3
## LAPACK: /usr/local/R/4.0.0/lib/R/lib/libRlapack.so
## 
## locale:
##  [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8    
##  [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8   
##  [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] showtext_0.9-1  showtextdb_3.0  sysfonts_0.8.2  gridExtra_2.3  
## [5] pophelper_2.3.1 captioner_2.2.3 knitr_1.30     
## 
## loaded via a namespace (and not attached):
##  [1] compiler_4.0.0      pillar_1.4.7        tools_4.0.0        
##  [4] digest_0.6.27       jsonlite_1.7.2      evaluate_0.14      
##  [7] memoise_1.1.0       lifecycle_0.2.0     tibble_3.0.4       
## [10] gtable_0.3.0        pkgconfig_2.0.3     rlang_0.4.9        
## [13] rstudioapi_0.13     curl_4.3            yaml_2.2.1         
## [16] pkgdown_1.6.1       xfun_0.19           stringr_1.4.0      
## [19] dplyr_1.0.2         desc_1.2.0          generics_0.1.0     
## [22] fs_1.5.0            vctrs_0.3.6         systemfonts_0.3.2  
## [25] combinat_0.0-8      rprojroot_2.0.2     grid_4.0.0         
## [28] tidyselect_1.1.0    glue_1.4.2          R6_2.5.0           
## [31] textshaping_0.2.1   rmarkdown_2.6       farver_2.0.3       
## [34] tidyr_1.1.2         ggplot2_3.3.2       purrr_0.3.4        
## [37] magrittr_2.0.1      scales_1.1.1        htmltools_0.5.0    
## [40] ellipsis_0.3.1      assertthat_0.2.1    lpSolve_5.6.15     
## [43] colorspace_2.0-0    labeling_0.4.2      label.switching_1.8
## [46] ragg_0.4.0          stringi_1.5.3       munsell_0.5.0      
## [49] crayon_1.3.4</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Roy Mathew Francis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
