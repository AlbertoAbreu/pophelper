<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generate CLUMPP output from a qlist — clumppExport • pophelper</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  
<meta property="og:title" content="Generate CLUMPP output from a qlist — clumppExport" />

<meta property="og:description" content="Takes a qlist and combines several repeats for each K into a 
single file along with a parameter file suitable for input to CLUMPP. The two 
output files are organised into folders by K. The CLUMPP executable file is executed in each directory to generate aligned output files. CLUMPP reorders the clusters for each K." />

<meta property="og:image" content="https://github.com/royfrancis/pophelper/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pophelper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-tools"></span>
     
    Vignette
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/index.html">Pophelper 2.3.0</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-book"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fa fa-history"></span>
     
    Versions
  </a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/royfrancis/pophelper">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate CLUMPP output from a qlist</h1>
    <small class="dont-index">Source: <a href='https://github.com/royfrancis/pophelper/blob/master/R/pophelper.R'><code>R/pophelper.R</code></a></small>
    <div class="hidden name"><code>clumppExport.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Takes a qlist and combines several repeats for each K into a 
single file along with a parameter file suitable for input to CLUMPP. The two 
output files are organised into folders by K. The CLUMPP executable file is executed in each directory to generate aligned output files. CLUMPP reorders the clusters for each K.</p>
    
    </div>

    <pre class="usage"><span class='fu'>clumppExport</span>(<span class='kw'>qlist</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>prefix</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>parammode</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
  <span class='kw'>paramrep</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>useexe</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>qlist</th>
      <td><p>A qlist (list of dataframes). An output from <code><a href='readQ.html'>readQ</a></code>.</p></td>
    </tr>
    <tr>
      <th>prefix</th>
      <td><p>A character prefix for folder names. By default, set to 'pop'.</p></td>
    </tr>
    <tr>
      <th>parammode</th>
      <td><p>A numeric 1, 2 or 3 indicating the algorithm option for 
CLUMPP paramfile. Calculated automatically by default. Set this value to 3 if 
CLUMPP runs too long. See details.</p></td>
    </tr>
    <tr>
      <th>paramrep</th>
      <td><p>A numeric indicating the number of repeats for CLUMPP 
paramfile. Calculated automatically by default. See details.</p></td>
    </tr>
    <tr>
      <th>useexe</th>
      <td><p>DEPRECATED. CLUMPP executable is no longer included from v2.3.0. 
Download and use CLUMPP manually or use the function <code><a href='alignK.html'>alignK</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The combined file and paramfile are written into respective folders 
named by K.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function only generates the files needed to run CLUMPP. 
The CLUMPP executable can be downloaded and run for downstream steps. It can 
be obtained from <a href='https://web.stanford.edu/group/rosenberglab/clumpp.html'>https://web.stanford.edu/group/rosenberglab/clumpp.html</a>.
Please remember to cite CLUMPP if this option is used.<br /></p>
<p>When multiple repeats are run for each K in runs, the order of 
clusters may be jumbled for each run. Therefore, when plotting multiple runs 
within each K, the colours cannot be assigned correctly. The software CLUMPP 
helps to overcome this issue by reordering the clusters correctly. This 
function <code>clumppExport()</code> takes multiple runs for each K and combines 
them into a single file and generates a parameter file for easy use with 
CLUMPP. Further details for CLUMPP can be found here: Jakobsson, M., and 
Rosenberg, N. A. (2007). CLUMPP: a cluster matching and permutation program 
for dealing with label switching and multimodality in analysis of population 
structure. Bioinformatics, 23(14), 1801-1806.<br />
<br />
<strong>parammode</strong><br />
The parammode (M) is the type of algorithm used. Option 1 is 'FullSearch' 
(takes the longest time), option 2 is 'Greedy' and option 3 is 'LargeKGreedy'
(fastest). If clumpp takes more than a few minutes, consider changing 
parammode to a higher number (ex. from 2 to 3), or open the exported 
paramfile and manually change GREEDY_OPTION to 3.<br />
<br />
The parammode and paramrep for CLUMPP paramfile is set based on this 
calculation.
T &lt;- factorial(k)*((runs*(runs-1))/2)*k*ind, where k is number of 
populations, runs is number of runs for k and ind is number of individuals.
If T &lt;= 100000000, then parammode is 2 and paramrep is 20, otherwise 
parammode is 3 and paramrep is set to 500.<br />
<br />
To find out more about parammode (algorithm type) and paramrep (repeats), 
refer to CLUMPP documentation.<br /></p>
<p>See the vignette for more details.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='alignK.html'>alignK</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='co'># generate input files for CLUMPP from STRUCTURE files</span>
<span class='no'>sfiles</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list.files'>list.files</a></span>(<span class='kw'>path</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"files/structure"</span>,<span class='kw'>package</span><span class='kw'>=</span><span class='st'>"pophelper"</span>),
<span class='kw'>full.names</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'>clumppExport</span>(<span class='fu'><a href='readQ.html'>readQ</a></span>(<span class='no'>sfiles</span>))

<span class='co'># generate input files for CLUMPP from ADMIXTURE files</span>
<span class='no'>afiles</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list.files'>list.files</a></span>(<span class='kw'>path</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"files/admixture"</span>,<span class='kw'>package</span><span class='kw'>=</span><span class='st'>"pophelper"</span>),
<span class='kw'>full.names</span><span class='kw'>=</span><span class='fl'>TRUE</span>)
<span class='fu'>clumppExport</span>(<span class='fu'><a href='readQ.html'>readQ</a></span>(<span class='no'>afiles</span>))

<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Roy Francis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

